{"version":3,"file":"compomint.min.js","sources":["../src/compomint-core.js"],"sourcesContent":["/*\n * Copyright (c) 2025-present, Choi Sungho\n * Code released under the MIT license\n */\n\n\n(function() {\n  \"use strict\";\n\n  // Polyfill\n  // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/assign#Polyfill\n  if (typeof Object.assign != \"function\") {\n    // Must be writable: true, enumerable: false, configurable: true\n    Object.defineProperty(Object, \"assign\", {\n      value: function assign(target, ...params) {\n        // .length of function is 2\n        // 'use strict';\n        if (target == null) {\n          // TypeError if undefined or null\n          throw new TypeError(\"Cannot convert undefined or null to object\");\n        }\n        let to = Object(target);\n        for (let index = 0, length = params.length; index < length; index++) {\n          let nextSource = params[index];\n          if (nextSource != null) {\n            // Skip over if undefined or null\n            for (let nextKey in nextSource) {\n              if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n                to[nextKey] = nextSource[nextKey];\n              }\n            }\n          }\n        }\n        return to;\n      },\n      writable: true,\n      configurable: true,\n    });\n  }\n\n  // from:https://github.com/jserz/js_piece/blob/master/DOM/ChildNode/remove()/remove().md\n\n  (function (arr) {\n    arr.forEach(function (item) {\n      if (!item) return;\n      if (item.hasOwnProperty(\"remove\")) {\n        return;\n      }\n      Object.defineProperty(item, \"remove\", {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value: function remove() {\n          if (this.parentNode !== null) {\n            this.parentNode.removeChild(this);\n          }\n        },\n      });\n    });\n  })([Element.prototype, CharacterData.prototype, DocumentType.prototype]);\n\n  // https://stackoverflow.com/questions/37588326/reliabilty-of-isconnected-field-in-dom-node\n  (function (supported) {\n    if (supported) return;\n    Object.defineProperty(window.Node.prototype, \"isConnected\", {\n      get: function () {\n        return document.body.contains(this);\n      },\n    });\n  })(\"isConnected\" in window.Node.prototype);\n\n  let root = this;\n  let Compomint = (root.compomint = root.compomint || {});\n  let tmplTool = (Compomint.tmplTool = Compomint.tmplTool || {});\n  let showTime = tmplTool.showTime || false;\n  let debug = tmplTool.debug != undefined ? tmplTool.debug : false;\n  let requestCacheControl = tmplTool.requestCacheControl || true;\n  let throwError =\n    tmplTool.throwError != undefined ? tmplTool.throwError : true;\n  let cachedTmpl = (Compomint.tmplCache = Compomint.tmplCache || new Map());\n  if (!cachedTmpl.has(\"anonymous\")) {\n    cachedTmpl.set(\"anonymous\", { elements: new Set() });\n  }\n  let isSupportTemplateTag = \"content\" in document.createElement(\"template\");\n\n  root.tmpl = {};\n\n  // When customizing `templateSettings`, if you don't want to define an\n  // interpolation, evaluation or escaping regex, we need one that is\n  // guaranteed not to match.\n  let noMatch = /(.)^/;\n  let escapes = {\n    \"'\": \"\\\\'\",\n    \"\\\\\": \"\\\\\\\\\",\n    \"\\r\": \"\\\\r\",\n    \"\\n\": \"\\\\n\",\n    \"\\t\": \"\\\\t\",\n    \"\\u2028\": \"\\u2028\",\n    \"\\u2029\": \"\\u2029\",\n    \"><\": \"><\",\n    \"<\": \"<\",\n    \">\": \">\",\n    //'#': '#'\n  };\n\n  let escaper = /\\>( |\\n)+\\<|\\>( |\\n)+|( |\\n)+\\<|\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;\n\n  let firstElementChild = function (ele) {\n    if (ele.firstElementChild) return ele.firstElementChild;\n    let children = ele.childNodes;\n    for (let i = 0, size = children.length; i < size; i++) {\n      if (children[i] instanceof Element) {\n        return children[i];\n      }\n    }\n    return null;\n  };\n\n  let childNodeCount = function (ele) {\n    return (\n      ele.childElementCount ||\n      Array.prototype.filter.call(ele.childNodes, function (child) {\n        return child instanceof Node;\n      }).length\n    );\n  };\n  let childElementCount = function (ele) {\n    return (\n      ele.childElementCount ||\n      Array.prototype.filter.call(ele.childNodes, function (child) {\n        return child instanceof Element;\n      }).length\n    );\n  };\n  let cleanNode = function (node) {\n    for (let n = 0; n < node.childNodes.length; n++) {\n      let child = node.childNodes[n];\n      if (\n        child.nodeType === 8 ||\n        (child.nodeType === 3 && !/\\S/.test(child.nodeValue))\n      ) {\n        node.removeChild(child);\n        n--;\n      } else if (child.nodeType === 1) {\n        cleanNode(child);\n      }\n    }\n  };\n\n  Compomint.templateSettings = {\n    firstElementChild: firstElementChild,\n    childElementCount: childElementCount,\n    style: {\n      pattern: /(\\<style id=[\\s\\S]+?\\>[\\s\\S]+?\\<\\/style\\>)/g,\n      exec: function (style) {\n        let dumy = document.createElement(\"template\");\n        dumy.innerHTML = style;\n        let styleNode = (dumy.content || dumy).querySelector(\"style\");\n        let oldStyleNode = document.getElementById(styleNode.id);\n        if (oldStyleNode) oldStyleNode.parentNode.removeChild(oldStyleNode);\n        document.head.appendChild(styleNode);\n        return \"\";\n      },\n    },\n    commentArea: {\n      pattern: /#\\\\#([\\s\\S]+?)#\\\\#/g,\n      exec: function (commentArea) {\n        return `'+\\n'##${commentArea}##'+\\n'`;\n      },\n    },\n    preEvaluate: {\n      pattern: /##!([\\s\\S]+?)##/g,\n      exec: function (preEvaluate, tmplId) {\n        new Function(\"tmplId\", preEvaluate)(tmplId);\n        return ``;\n      },\n    },\n    interpolate: {\n      //pattern: /(?:##=|\\$\\{)([\\s\\S]+?)(?:##|\\})/g, // ##=##, ${}\n      pattern: /##=([\\s\\S]+?)##/g, // ##=##, ${}\n      exec: function (interpolate) {\n        let interpolateSyntax = `typeof (interpolate)=='function' ? (interpolate)() : (interpolate)`;\n        return (`';(() => {let interpolate=${interpolate};\\n__p+=((__t=(${interpolateSyntax}))==null?'':__t);})()\\n__p+='`);\n      },\n    },\n    namedElement: {\n      pattern: /data-co-named-element=\"##:([\\s\\S]+?)##\"/g,\n      exec: function (key) {\n        let source = `';\\nvar eventId = (__lazyScope.namedElementArray.length);\\n__p+='data-co-named-element=\\\"'+eventId+'\\\"';\\n\n__lazyScope.namedElementArray[eventId] = ${key};\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data, lazyScope, tmplScope, wrapper) {\n        lazyScope.namedElementArray.forEach(function (key, eventId) {\n          let $elementTrigger = wrapper.querySelector(\n            '[data-co-named-element=\"' + eventId + '\"]'\n          );\n          if (!$elementTrigger) return;\n          delete $elementTrigger.dataset.coNamedElement;\n          tmplScope[key] = $elementTrigger;\n        });\n      },\n    },\n    elementRef: {\n      pattern: /data-co-element-ref=\"##:([\\s\\S]+?)##\"/g,\n      exec: function (key) {\n        var source = `';\\nvar eventId = (__lazyScope.elementRefArray.length);\\n__p+='data-co-element-ref=\\\"'+eventId+'\\\"';\nvar ${key} = null;\\n__lazyScope.elementRefArray[eventId] = function(target) {${key} = target;};\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data, lazyScope, tmplScope, wrapper) {\n        lazyScope.elementRefArray.forEach(function (func, eventId) {\n          let $elementTrigger = wrapper.querySelector(\n            '[data-co-element-ref=\"' + eventId + '\"]'\n          );\n          if (!$elementTrigger) return;\n          delete $elementTrigger.dataset.coVar;\n          func.call($elementTrigger, $elementTrigger);\n        });\n      },\n    },\n    elementLoad: {\n      pattern: /data-co-load=\"##:([\\s\\S]+?)##\"/g,\n      exec: function (elementLoad) {\n        let elementLoadSplitArray = elementLoad.split(\"::\");\n        let source = `';\\nlet eventId = (__lazyScope.elementLoadArray.length);\\n__p+='data-co-load=\\\"'+eventId+'\\\"';\n__lazyScope.elementLoadArray[eventId] = {loadFunc: ${elementLoadSplitArray[0]}, customData: ${elementLoadSplitArray[1]}};\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data, lazyScope, tmplScope, wrapper) {\n        lazyScope.elementLoadArray.forEach(function (elementLoad, eventId) {\n          let $elementTrigger = wrapper.querySelector(\n            '[data-co-load=\"' + eventId + '\"]'\n          );\n          if (!$elementTrigger) return;\n          delete $elementTrigger.dataset.coLoad;\n          let parentElement = $elementTrigger.parentElement;\n          elementLoad.loadFunc.call(\n            $elementTrigger,\n            $elementTrigger,\n            {\n              \"data\": data,\n              \"element\": $elementTrigger,\n              \"customData\": elementLoad.customData,\n              \"parentElement\": parentElement,\n              \"component\": tmplScope,\n            },\n          );\n        });\n      },\n    },\n    event: {\n      pattern: /data-co-event=\"##:([\\s\\S]+?)##\"/g,\n      exec: function (event) {\n        let eventStrArray = event.split(\":::\");\n        let source = `';\\n(() => {let eventId = (__lazyScope.eventArray.length);\\n__p+='data-co-event=\\\"'+eventId+'\\\"';\\n`;\n        let eventArray = new Array();\n        for (let i = 0, size = eventStrArray.length; i < size; i++) {\n          let eventSplitArray = eventStrArray[i].split(\"::\");\n          eventArray.push(\n            `{eventFunc: ${eventSplitArray[0]}, $parent: this, customData: ${eventSplitArray[1]}}`\n          );\n        }\n        source += `__lazyScope.eventArray[eventId] = [${eventArray.join(\",\")}];})()\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data, lazyScope, tmplScope, wrapper) {\n        let self = this;\n        let attacher = self.event.attacher;\n        lazyScope.eventArray.forEach(function (selectedArray, eventId) {\n          let $elementTrigger = wrapper.querySelector(\n            `[data-co-event=\"${eventId}\"]`\n          );\n          if (!$elementTrigger) return;\n          delete $elementTrigger.dataset.coEvent;\n          for (let i = 0, size = selectedArray.length; i < size; i++) {\n            let selected = selectedArray[i];\n            if (selectedArray[i].eventFunc) {\n              if (selected.eventFunc instanceof Array) {\n                selected.eventFunc.forEach(function (func) {\n                  attacher(\n                    self, data, lazyScope, tmplScope, wrapper, $elementTrigger,\n                    func,\n                    selected\n                  );\n                });\n              } else {\n                attacher(\n                  self, data, lazyScope, tmplScope, wrapper, $elementTrigger,\n                  selected.eventFunc,\n                  selected\n                );\n              }\n            }\n          }\n        });\n      },\n      trigger: function (target, eventName) {\n        let customEvent = new Event(eventName, {\n          bubbles: true,\n          cancelable: true\n        });\n        target.dispatchEvent(customEvent);\n      },\n      attacher: function (\n        self,\n        data,\n        lazyScope,\n        tmplScope,\n        wrapper,\n        $elementTrigger,\n        eventFunc,\n        eventData\n      ) {\n        let trigger = self.event.trigger;\n        let $childTarget = self.firstElementChild(wrapper);\n        let $targetElement =\n          self.childElementCount(wrapper) == 1 ? $childTarget : null;\n\n        if (!eventFunc) {\n          return;\n        }\n\n        let eventFuncParams = [\n          $elementTrigger,\n          null,\n          {\n            \"data\": data,\n            \"customData\": eventData.customData,\n            \"element\": $elementTrigger,\n            \"componentElement\": $targetElement || $childTarget.parentElement,\n            \"component\": tmplScope,\n          },\n        ];\n\n        if (eventFunc instanceof Function) {\n          $elementTrigger.addEventListener(\"click\", function (event) {\n            event.stopPropagation();\n            eventFuncParams[1] = event;\n            eventFunc.call(...eventFuncParams);\n          });\n          return;\n        }\n        let triggerKey = eventFunc.triggerKey;\n        if (triggerKey) {\n          tmplScope.trigger = tmplScope.trigger || {};\n          tmplScope.trigger[triggerKey] = {};\n        }\n        Object.keys(eventFunc).forEach(function (eventType) {\n          if (eventType == \"load\") {\n            eventFuncParams[1] = $elementTrigger;\n            eventFunc[eventType].call(...eventFuncParams);\n            return;\n          } else if (eventType == \"ref\") {\n            tmplScope[eventFunc[eventType]] = $elementTrigger;\n            return;\n          } else if (eventType == \"triggerKey\") {\n            return;\n          }\n\n          $elementTrigger.addEventListener(eventType, function (event) {\n            event.stopPropagation();\n            eventFuncParams[1] = event;\n            eventFunc[eventType].call(...eventFuncParams);\n          });\n\n          if (triggerKey) {\n            tmplScope.trigger[triggerKey][eventType] = function () {\n              trigger($elementTrigger, eventType);\n            };\n          }\n        });\n      },\n    },\n    element: {\n      pattern: /##%([\\s\\S]+?)##/g,\n      exec: function (target) {\n        let elementSplitArray = target.split(\"::\");\n        let source =\n          `';\\n(() => {let elementId = (__lazyScope.elementArray.length);\\n__p+='<template data-co-tmpl-element-id=\\\"'+elementId+'\\\"></template>';\n__lazyScope.elementArray[elementId] = {target: ${elementSplitArray[0]}, nonblocking: ${(elementSplitArray[1] || false)}};})()\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data, lazyScope, tmplScope, wrapper) {\n        let self = this;\n        lazyScope.elementArray.forEach(function (ele, elementId) {\n          let childTarget = ele.target;\n          let nonblocking = ele.nonblocking;\n          let $tmplElement = wrapper.querySelector(\n            `template[data-co-tmpl-element-id=\"${elementId}\"]`\n          );\n          if (childTarget instanceof Array) {\n            let docFragment = document.createDocumentFragment();\n            childTarget.forEach(function (child) {\n              if (!child) return;\n              let childElement = child.element || child;\n              if (typeof childElement === \"string\") {\n                docFragment.appendChild(\n                  self.element.stringToElement(childElement)\n                );\n              } else if (typeof childElement === \"number\") {\n                docFragment.appendChild(\n                  self.element.stringToElement(childElement)\n                );\n              } else if (typeof childElement === \"function\") {\n                docFragment.appendChild(\n                  self.element.stringToElement(childElement())\n                );\n              } else {\n                docFragment.appendChild(childElement);\n              }\n              if (child.beforeAppendTo) {\n                child.parent = child.parentNode;\n                child.parentScope = tmplScope;\n                if (child.beforeAppendTo) child.beforeAppendTo();\n              }\n            });\n\n            $tmplElement.parentNode.replaceChild(docFragment, $tmplElement);\n            childTarget.forEach(function (child) {\n              if (child && child.afterAppendTo)\n                setTimeout(function () {\n                  child.afterAppendTo();\n                });\n            });\n          } else if (typeof childTarget === \"string\") {\n            $tmplElement.parentNode.replaceChild(\n              self.element.stringToElement(childTarget),\n              $tmplElement\n            );\n          } else if (typeof childTarget === \"number\") {\n            $tmplElement.parentNode.replaceChild(\n              self.element.stringToElement(childTarget),\n              $tmplElement\n            );\n          } else if (typeof childTarget === \"function\") {\n            $tmplElement.parentNode.replaceChild(\n              self.element.stringToElement(childTarget()),\n              $tmplElement\n            );\n          } else if (\n            (childTarget && (childTarget.element || childTarget)) instanceof\n            Element\n          ) {\n            let doFunc = function () {\n              let childElement = childTarget.element || childTarget;\n              let parentNode = $tmplElement.parentNode;\n              let node1 = null;\n              if (childElement instanceof DocumentFragment) {\n                node1 = childElement.firstChild;\n              }\n\n              if (childTarget.beforeAppendTo) childTarget.beforeAppendTo();\n              let replacedNode = parentNode.replaceChild(\n                childElement,\n                $tmplElement\n              );\n              if (childTarget.afterAppendTo)\n                setTimeout(function () {\n                  childTarget.afterAppendTo();\n                });\n              if (childTarget.tmplId) {\n                if (node1) {\n                  childTarget.this = node1.parentNode;\n                }\n                childTarget.parentScope = tmplScope;\n              }\n            };\n            nonblocking == undefined || nonblocking === false\n              ? doFunc()\n              : setTimeout(doFunc, nonblocking);\n          } else {\n            $tmplElement.parentNode.removeChild($tmplElement);\n          }\n        });\n      },\n      stringToElement: function (str) {\n        if (!isNaN(str)) {\n          return document.createTextNode(str);\n        } else if (str && str.startsWith(\"<>\")) {\n          let temp = document.createElement(\"template\");\n          temp.innerHTML = str.replace(\"<>\", \"\");\n          return temp.content;\n        } else {\n          return document.createTextNode(str);\n        }\n      },\n    },\n    lazyEvaluate: {\n      pattern: /###([\\s\\S]+?)##/g,\n      exec: function (lazyEvaluate) {\n        let source = `';\\n__lazyScope.lazyEvaluateArray.push(function(data) {${lazyEvaluate}});\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data, lazyScope, tmplScope, wrapper) {\n        let $childTarget = this.firstElementChild(wrapper);\n        let $targetElement =\n          this.childElementCount(wrapper) == 1 ? $childTarget : null;\n        lazyScope.lazyEvaluateArray.forEach(function (selectedFunc, idx) {\n          selectedFunc.call($targetElement || $childTarget.parentElement, data);\n        });\n        return;\n      },\n    },\n    escape: {\n      pattern: /##-([\\s\\S]+?)##/g,\n      exec: function (escape) {\n        return (`'+\\n((__t=(${escape}))==null?'':compomint.tmplTool.escapeHtml.escape(__t))+\\n'`);\n      },\n    },\n    evaluate: {\n      pattern: /##([\\s\\S]+?)##/g,\n      exec: (evaluate) => {\n        return \"';\\n\" + evaluate + \"\\n__p+='\";\n      },\n    },\n    /*\n    normal  : {\n      pattern: /([\\s\\S]+?)/g,\n      exec: function(normal) {\n        //console.log(normal);\n        return normal.replace(escaper, escapeFunc);\n      }\n    },\n    */\n    dataKeyName: \"data\",\n    statusKeyName: \"status\",\n    componentKeyName: \"component\",\n    i18nKeyName: \"i18n\",\n  };\n  \n  let escapeHtml = (function () {\n    let escapeMap = {\n      \"&\": \"&amp;\",\n      \"<\": \"&lt;\",\n      \">\": \"&gt;\",\n      '\"': \"&quot;\",\n      \"'\": \"&#x27;\",\n      \"`\": \"&#x60;\",\n      \"\\n\": \"&#10;\",\n    };\n    let unescapeMap = (function () {\n      let unescapeMap = {};\n      Object.keys(escapeMap).forEach(function (ele) {\n        unescapeMap[escapeMap[ele]] = ele;\n      });\n      return unescapeMap;\n    })();\n\n    // from underscore.js\n    let createEscaper = function (map) {\n      let escaper = function (match) {\n        return map[match];\n      };\n      let source = `(?:${Object.keys(map).join(\"|\")})`;\n      let testRegexp = RegExp(source);\n      let replaceRegexp = RegExp(source, \"g\");\n      return function (string) {\n        string = string == null ? \"\" : `${string}`;\n        return testRegexp.test(string)\n          ? string.replace(replaceRegexp, escaper)\n          : string;\n      };\n    };\n\n    return {\n      escape: createEscaper(escapeMap),\n      unescape: createEscaper(unescapeMap),\n    };\n  })();\n  tmplTool.escapeHtml = escapeHtml;\n\n  let matcherFunc = function (settings) {\n    let patternArray = new Array();\n    let execArray = new Array();\n    let lazyExecArray = {};\n    let lazyScope = {};\n    let setting = null;\n    Object.keys(settings).forEach(function (key) {\n      setting = settings[key];\n      if (setting.pattern) {\n        patternArray.push((setting.pattern || noMatch).source);\n        execArray.push(setting.exec);\n      }\n      if (setting.lazyExec) {\n        lazyExecArray[`${key}Array`] = setting.lazyExec;\n        lazyScope[`${key}Array`] = new Array();\n      }\n    });\n    return {\n      settings: settings,\n      pattern: new RegExp(patternArray.join(\"|\"), \"g\"),\n      exec: execArray,\n      lazyExecKeys: Object.keys(lazyScope),\n      lazyExec: lazyExecArray,\n      lazyScopeSeed: JSON.stringify(lazyScope),\n    };\n  };\n\n  let escapeFunc = function (match) {\n    return escapes[match] || escapes[match.replace(/[ \\n]/g, \"\")] || \"\";\n  };\n\n  let defaultMatcher = matcherFunc(Compomint.templateSettings);\n\n  let templateParser = function (tmplId, text, matcher) {\n    if (showTime) console.time(`tmpl: ${tmplId}`);\n\n    let index = 0;\n    let source = \"\";\n\n    text.replace(matcher.pattern, function (...params) {\n      //let match = arguments[0];\n      //let offset = arguments[arguments.length-2];\n      let match = params[0];\n      let offset = params[params.length - 2];\n      source += text.slice(index, offset).replace(escaper, escapeFunc);\n      let selected,\n        i = null;\n      //Array.prototype.slice.call(arguments, 1, -2).some(function(value, idx, arr) {\n      params.slice(1, -2).some(function (value, idx, arr) {\n        if (!!value) {\n          selected = value;\n          i = idx;\n          return true;\n        }\n        return false;\n      });\n\n      if (!selected) return match;\n      source += matcher.exec[i].call(matcher.settings, selected, tmplId);\n      index = offset + match.length;\n      return match;\n    });\n\n    if (showTime) console.timeEnd(`tmpl: ${tmplId}`);\n    return source + text.slice(index).replace(escaper, escapeFunc);\n  };\n  \n  // JavaScript micro-templating, similar to John Resig's implementation.\n  let templateBuilder = (Compomint.template = function compomint_templateBuilder(\n    tmplId,\n    templateText,\n    tmplSettings\n  ) {\n    let settings = Compomint.templateSettings;\n    let matcher = defaultMatcher;\n    if (tmplSettings) {\n      settings = Object.assign({}, Compomint.templateSettings, tmplSettings);\n      matcher = matcherFunc(settings);\n    }\n    let source = `/* tmplId: ${tmplId} */\\n//# sourceURL=http://tmpl//${tmplId.split(\"-\").join(\"//\")}.js\\nlet __t,__p='';\n__p+='${templateParser(tmplId, templateText, matcher)}';\\nreturn __p;`;\n    let render = null;\n    try {\n      renderFunc = new Function(\n        settings.dataKeyName,\n        settings.statusKeyName,\n        settings.componentKeyName,\n        settings.i18nKeyName,\n        \"__lazyScope\",\n        source\n      );\n    } catch (e) {\n      let debugErrorLine = function (source, e) {\n        console.log(tmplId, e.lineNumber, e.columnNumber);\n        new Function(\n          settings.dataKeyName,\n          settings.statusKeyName,\n          settings.componentKeyName,\n          settings.i18nKeyName,\n          \"__lazyScope\",\n          source\n        );\n      };\n      if (throwError) {\n        debugErrorLine(source, e);\n        throw e;\n      } else {\n        return;\n      }\n    }\n\n    let tmpl = function compomint_tmpl(data, wrapperElement, callback, tmplScope) {\n      if (wrapperElement instanceof Function) {\n        callback = wrapperElement;\n        wrapperElement = undefined;\n      }\n\n      let dataKeyName = settings.dataKeyName;\n      let statusKeyName = settings.statusKeyName;\n      let lazyScope = JSON.parse(matcher.lazyScopeSeed);\n      tmplScope = Object.assign(tmplScope || {}, {\n        tmplId: tmplId,\n        //_id: tmplTool.genId(tmplId),\n        //[statusKeyName]: {},\n        replace: function (scope) {\n          tmplScope.element.parentElement.replaceChild(\n            scope.element || scope,\n            tmplScope.element\n          );\n        },\n        remove: function (spacer) {\n          if (tmplScope.beforeRemove) tmplScope.beforeRemove();\n          if (tmplScope.element.parentElement) {\n            if (spacer) {\n              let dumy = document.createElement(\"template\");\n              tmplScope.element.parentElement.replaceChild(\n                dumy,\n                tmplScope.element\n              );\n              tmplScope.element = dumy;\n            } else {\n              tmplScope.element.parentElement.removeChild(tmplScope.element);\n            }\n          }\n          if (tmplScope.afterRemove) tmplScope.afterRemove();\n          return tmplScope.element;\n        },\n        appendTo: function (parentElement) {\n          if (tmplScope.beforeAppendTo) tmplScope.beforeAppendTo();\n          if (parentElement) parentElement.appendChild(tmplScope.element);\n          if (tmplScope.afterAppendTo) tmplScope.afterAppendTo();\n          return tmplScope;\n        },\n      });\n      if (!tmplScope._id) {\n        tmplScope._id = tmplTool.genId(tmplId);\n      }\n      tmplScope[dataKeyName] = data;\n      if (tmplScope[statusKeyName] == undefined) tmplScope[statusKeyName] = {};\n      let hasParent = wrapperElement ? true : false;\n      let temp = document.createElement(\"template\");\n      let returnTarget = null;\n\n      if (showTime) console.time(`render: ${tmplId}`);\n\n      let html = null;\n      try {\n        html = !data\n          ? `<template></template>`\n          : renderFunc.call(\n              wrapperElement,\n              data,\n              tmplScope[statusKeyName],\n              tmplScope,\n              Compomint.i18n[tmplId],\n              lazyScope,\n            );\n      } catch (e) {\n        let debugErrorLine = function (source) {\n          console.log(`Error: ${tmplId}`);\n          renderFunc.call(\n            wrapperElement,\n            data,\n            tmplScope[statusKeyName],\n            tmplScope,\n            Compomint.i18n[tmplId],\n            lazyScope,\n          );\n        };\n        if (throwError) {\n          debugErrorLine(source, e);\n          throw e;\n        } else {\n          return;\n        }\n      }\n      if (showTime) console.timeEnd(`render: ${tmplId}`);\n\n      temp.innerHTML = html;\n\n      let docFragment = temp.content || temp;\n      if (docFragment.tagName == \"TEMPLATE\") {\n        // for IE11\n        let children = docFragment.children;\n        docFragment = document.createDocumentFragment();\n        Array.prototype.forEach.call(children, function (child) {\n          docFragment.appendChild(child);\n        });\n      }\n      let lazyExec = matcher.lazyExec;\n      if (data)\n        matcher.lazyExecKeys.forEach(function (key) {\n          if (lazyScope[key].length == 0) return;\n          lazyExec[key].call(settings, data, lazyScope, tmplScope, docFragment);\n        });\n\n      if (hasParent) {\n        while (wrapperElement.firstElementChild) {\n          wrapperElement.removeChild(wrapperElement.firstElementChild);\n        }\n        tmplScope.wrapperElement = wrapperElement;\n      }\n\n      if (docFragment.firstChild && docFragment.firstChild.nodeType == 8) {\n        returnTarget = docFragment.firstChild;\n      } else if (childElementCount(docFragment) == 1) {\n        returnTarget = firstElementChild(docFragment);\n        if (hasParent) {\n          if (tmplScope.beforeAppendTo) tmplScope.beforeAppendTo();\n          wrapperElement.appendChild(returnTarget);\n          if (tmplScope.afterAppendTo) tmplScope.afterAppendTo();\n        }\n      } else {\n        if (hasParent) {\n          if (tmplScope.beforeAppendTo) tmplScope.beforeAppendTo();\n          wrapperElement.appendChild(docFragment);\n          if (tmplScope.afterAppendTo) tmplScope.afterAppendTo();\n          returnTarget = wrapperElement;\n        } else {\n          returnTarget = docFragment;\n        }\n      }\n\n      if (data && data.$props) {\n        for (let prop in data.$props) {\n          returnTarget[prop] = data.$props[prop];\n        }\n      }\n\n      returnTarget.normalize();\n      cleanNode(returnTarget);\n      tmplScope.element = returnTarget;\n      if (tmplTool.liveReloadSupport) tmplTool.liveReloadSupport(tmplScope);\n\n      // style to shadow\n      let style = returnTarget.querySelector\n        ? returnTarget.querySelector(\"style[scoped], style[shadow]\")\n        : null;\n      if (style && returnTarget.createShadowRoot) {\n        let shadow = returnTarget.createShadowRoot();\n        document.head.appendChild(style);\n        let styles = \"\";\n        let sheet = style.sheet;\n        for (let i = 0, size = sheet.cssRules.length; i < size; i++) {\n          styles += `::content ${sheet.cssRules[i].cssText.replace(\"::content\", \"\")}`;\n        }\n        style.innerHTML = styles;\n        shadow.appendChild(style);\n        let content = document.createElement(\"content\");\n        content.setAttribute(\"select\", \"*\");\n        shadow.appendChild(content);\n      }\n\n      if (callback) {\n        callback.call(wrapperElement, tmplScope);\n      }\n\n      tmplScope.release = function () {\n        let props = Object.getOwnPropertyNames(tmplScope);\n        props.splice(props.indexOf(statusKeyName), 1);\n        for (let i = 0; i < props.length; i++) {\n          delete tmplScope[props[i]];\n        }\n      };\n\n      tmplScope.render = function (fdata) {\n        let tmplScope = this.tmplScope || this;\n        let target = tmplScope.element;\n        let tmpl = compomint.tmpl(tmplScope.tmplId);\n        let beforeRemove = tmplScope.beforeRemove;\n        let afterRemove = tmplScope.afterRemove;\n        tmplScope.element = void 0;\n        tmplScope.data = void 0;\n        tmplScope.render = void 0;\n        tmplScope.beforeRemove = void 0;\n        tmplScope.afterRemove = void 0;\n\n        if (tmplScope.wrapperElement) {\n          let wrapperElement = tmplScope.wrapperElement;\n          if (beforeRemove) beforeRemove();\n          tmplScope.release();\n          tmplScope = tmpl(fdata, wrapperElement, null, tmplScope);\n          if (afterRemove) afterRemove();\n          return tmplScope;\n        } else {\n          tmplScope.release();\n          tmplScope = tmpl(fdata, null, null, tmplScope);\n          if (target.parentElement) {\n            let newElement = tmplScope.element;\n            if (beforeRemove) beforeRemove();\n            if (tmplScope.beforeAppendTo) tmplScope.beforeAppendTo();\n            let replacedNode = target.parentElement.replaceChild(\n              newElement,\n              target\n            );\n            while (target.firstChild) {\n              target.removeChild(target.firstChild);\n            }\n            target = void 0;\n            if (tmplScope.afterAppendTo) tmplScope.afterAppendTo();\n            if (afterRemove) afterRemove();\n          }\n          return tmplScope;\n        }\n      };\n\n      tmplScope.refresh = function (fdata) {\n        let tmplScope = this.tmplScope || this;\n        let target = tmplScope.element;\n        let data = tmplScope.data;\n        if (tmplScope.beforeRefresh) tmplScope.beforeRefresh();\n        let scope = tmplScope.render(Object.assign(data || {}, fdata));\n        if (tmplScope.afterRefresh) tmplScope.afterRefresh();\n        return scope;\n      };\n\n      tmplScope.reflash = tmplScope.refresh;\n\n      return tmplScope;\n    };\n\n    Object.defineProperty(tmpl, \"name\", { value: tmplId, writable: false });\n    //tmpl.source = 'function ' + tmplId + '_source (' + (settings.variable || 'data') + '){\\n' + source + '}';\n    let tmpl_source = `function ${tmplId}_source (${(settings.variable || \"data\")}){\\n${source}}`;\n\n    if (tmplId) {\n      let tmplMeta = {\n        tmpl: tmpl,\n        source: escapeHtml.escape(tmpl_source),\n        templateText: escapeHtml.escape(templateText),\n      };\n      cachedTmpl.set(tmplId, tmplMeta);\n      let tmplIdNames = tmplId.split(\"-\");\n      if (tmplIdNames.length > 1) {\n        let group = tmplIdNames[0];\n        let groupObj = root.tmpl[group];\n        if (!groupObj) {\n          root.tmpl[group] = groupObj = {};\n        }\n        let tmplIdSub = tmplIdNames\n          .slice(1)\n          .join(\"\")\n          .replace(/-([a-z])/g, function (g) {\n            return g[1].toUpperCase();\n          });\n        groupObj[tmplIdSub] = tmplMeta.tmpl;\n      }\n    }\n    return tmpl;\n  });\n\n  Compomint.remapTmpl = function (json) {\n  Object.keys(json).forEach(function (key) {\n    cachedTmpl.set(json[key], cachedTmpl.get(key));\n  });\n  };\n\n  Compomint.tmpl = function (tmplId) {\n  let tmplFunc = cachedTmpl.get(tmplId);\n  return tmplFunc ? tmplFunc.tmpl : null;\n  };\n\n  let safeTemplate = function (source) {\n    let template;\n    if (source.querySelectorAll) {\n      return source;\n    } else if (isSupportTemplateTag) {\n      template = document.createElement(\"template\");\n      //template.innerHTML = source.replace(/(?<=<template[^]*?)<(?=[^]*?<\\/template>)/g, '&lt;');\n      template.innerHTML = source.replace(\n        /<(?!template|\\/template|body|\\/body|html|\\/html|head|\\/head|script|\\/script|link|\\/link|meta|\\/meta|!--)/gi,\n        \"&lt;\"\n      );\n      /*\n      template.innerHTML = source.replace(/<template([\\s\\S]*?)<\\/template>/gi, (match, p1)=>{\n        return `<template${p1.replace(/</g, '&lt;')}</template>`;\n      });\n      */\n    } else {\n      template = document.createElement(\"template\");\n      template.innerHTML = source\n        .replace(\n          /<(?!template|\\/template|body|\\/body|html|\\/html|head|\\/head|script|\\/script|link|\\/link|meta|\\/meta|!--)/gi,\n          \"&lt;\"\n        )\n        .replace(/<template/g, '<script type=\"template\"')\n        .replace(/<\\/template>/g, \"</script>\");\n    }\n    return template;\n  };\n\n  let addTmpl = (tmplTool.addTmpl = function (tmplId, element, tmplSettings) {\n    let templateText = element instanceof Element ? element.innerHTML : element;\n    templateText = escapeHtml.unescape(\n      templateText.replace(/<!---|--->/gi, \"\")\n    );\n    return templateBuilder(tmplId, templateText, tmplSettings);\n  });\n\n  let addTmpls = (tmplTool.addTmpls = function (\n    source,\n    removeInnerTemplate,\n    tmplSettings\n  ) {\n    if (typeof removeInnerTemplate !== \"boolean\" && tmplSettings == undefined)\n      tmplSettings = removeInnerTemplate;\n    let template = safeTemplate(source);\n    let tmplNodes = (template.content || template).querySelectorAll(\n      'template,script[type=\"template\"]'\n    );\n\n    let node = null;\n    for (let i = 0, size = tmplNodes.length; i < size; i++) {\n      node = tmplNodes.item(i);\n      node.dataset.coLoadScript\n        ? addTmpl(node.id, node, tmplSettings)({})\n        : addTmpl(node.id, node, tmplSettings);\n      if (removeInnerTemplate) node.parentNode.removeChild(node);\n    }\n      return template;\n    });\n\n  let addTmplByUrl = (tmplTool.addTmplByUrl = function compomint_addTmplByUrl(\n    importData,\n    option,\n    callback\n  ) {\n    if (!callback && typeof option === \"function\") {\n      callback = option;\n      option = {};\n    }\n    option = Object.assign(\n      { loadScript: true, loadStyle: true, loadLink: true },\n      option\n    );\n\n    let importDataParser = function (obj) {\n      if (typeof obj === \"string\") {\n        return { url: obj, option: option };\n      } else {\n        obj.option = Object.assign({}, option, obj.option);\n        return obj;\n      }\n    };\n    let appendToHead = function (elements) {\n      if (elements && elements.length > 0) {\n        Array.prototype.forEach.call(elements, function (element) {\n          if (element.id) {\n            let oldElement = document.getElementById(element.id);\n            if (oldElement) oldElement.parentNode.removeChild(oldElement);\n          }\n          document.body.appendChild(element);\n        });\n      }\n    };\n    let importFunc = function (source, option) {\n      let template = safeTemplate(source);\n      addTmpls(template, option.tmplSettings);\n      let content = template.content || template;\n      if (option.loadLink) {\n        let links = content.querySelectorAll(\"link\");\n        appendToHead(links);\n      }\n      if (option.loadStyle) {\n        let styles = content.querySelectorAll(\"style[id]\");\n        appendToHead(styles);\n      }\n      if (option.loadScript) {\n        let scripts = content.querySelectorAll(\n          'script[id]:not([type=\"template\"])'\n        );\n        scripts = Array.prototype.filter\n          .call(scripts, function (node) {\n            return node.innerHTML;\n          })\n          .map(function (node) {\n            let scriptText = node.innerHTML;\n            let scriptElm = document.createElement(\"script\");\n            let inlineCode = document.createTextNode(scriptText);\n            scriptElm.appendChild(inlineCode);\n            return scriptElm;\n          });\n        appendToHead(scripts);\n      }\n    };\n\n    if (Array.isArray(importData)) {\n      let arraySize = importData.length;\n      importData.forEach(function (data) {\n        data = importDataParser(data);\n        let src = data.url;\n        if (src.indexOf(\".js\") > -1) {\n          let script = tag(\"script\", { async: true, src: src });\n          script.addEventListener(\"load\", function (event) {\n            arraySize--;\n            if (arraySize == 0 && callback) callback();\n          });\n          document.head.appendChild(script);\n          if (arraySize == 0 && callback) callback();\n        } else if (src.indexOf(\".css\") > -1) {\n          let link = tag(\"link\", {\n            type: \"text/css\",\n            rel: \"stylesheet\",\n            href: src,\n          });\n          document.head.appendChild(link);\n          arraySize--;\n          if (arraySize == 0 && callback) callback();\n        } else {\n          requestFunc(data.url, null, function (source) {\n            importFunc(source, data.option);\n            arraySize--;\n            if (arraySize == 0 && callback) callback();\n          });\n        }\n      });\n    } else {\n      importData = importDataParser(importData);\n      requestFunc(importData, null, function (source) {\n        importFunc(source, importData.option);\n        if (callback) callback();\n      });\n    }\n  });\n\n  let requestFunc = function (url, option, callback) {\n    let xmlhttp = new XMLHttpRequest();\n    /*\n    let stroage = localStorage || sessionStorage;\n    if (requestCacheControl && stroage) {\n      let cacheStatus = JSON.stringify(stroage['compomint.requestCacheStatus'] || '{}');\n      let urlCacheStatus = cacheStatus[url];\n      if (urlCacheStatus) {\n        let lastModified = urlCacheStatus['Last-Modified'];\n        let eTag = urlCacheStatus['ETag'];\n\n      }\n    }\n    */\n    xmlhttp.onreadystatechange = function () {\n      if (xmlhttp.readyState == XMLHttpRequest.DONE) {\n        if (xmlhttp.status == 200 || xmlhttp.status === 0) {\n          callback(xmlhttp.responseText, xmlhttp.status, xmlhttp);\n        } else if (xmlhttp.status == 400) {\n          alert(\"There was an error 400\");\n        } else {\n          console.log(\"!200\", xmlhttp.status, url, option);\n        }\n      }\n    };\n\n    if (option) {\n      xmlhttp.open(option.method || \"GET\", url, true);\n      if (option.timeout) xmlhttp.timeout = option.timeout;\n      if (option.headers)\n        Object.keys(option.headers).forEach(function (key) {\n          xmlhttp.setRequestHeader(key, option.headers[key]);\n        });\n      xmlhttp.send(option.body);\n    } else {\n      xmlhttp.open(\"GET\", url, true);\n      xmlhttp.send();\n    }\n  };\n\n  Compomint.i18n = {};\n  tmplTool.i18n = function (i18nObj, defaultText) {\n    let label = i18nObj[document.documentElement.lang] || defaultText;\n    if (!label) {\n      if (debug)\n        console.log(\n          `Label not exist! (lang: ${document.documentElement.lang})`\n        );\n    }\n    return label;\n  };\n\n  tmplTool.addI18n = function (fullKey, i18nObj) {\n    let langKeyNames = fullKey.split(\".\");\n    let target = Compomint.i18n;\n    let keyLength = langKeyNames.length - 1;\n\n    langKeyNames.forEach(function (key, i) {\n      if (keyLength === i) {\n        if (!target[key]) {\n          target[key] = function (defaultText) {\n            let label = i18nObj[document.documentElement.lang] || defaultText;\n            if (!label) {\n              if (debug) console.log(\"Label key [\" + fullKey + \"] is empty!\");\n            }\n            return label;\n          };\n        }\n\n        Object.keys(i18nObj)\n          .filter((lang) => i18nObj[lang] instanceof Object)\n          .forEach((subKey) => {\n            tmplTool.addI18n(fullKey + \".\" + subKey, i18nObj[subKey]);\n            delete i18nObj[subKey];\n            return;\n          });\n      } else {\n        if (!target[key]) {\n          target[key] = {};\n        }\n        target = target[key];\n      }\n    });\n  };\n  tmplTool.addI18ns = function (i18nObjs) {\n    Object.keys(i18nObjs || {}).forEach(function (key) {\n      tmplTool.addI18n(key, i18nObjs[key]);\n    });\n  };\n\n  let elementCount = 0;\n  tmplTool.genId = function (tmplId) {\n    elementCount++;\n    return tmplId + elementCount;\n  };\n\n  let tag = (tmplTool.tag = function (tagName, attrs) {\n    attrs = attrs || [];\n    let element = document.createElement(tagName);\n    Object.keys(attrs).forEach(function (key) {\n      //element.setAttribute(key, attrs[key]);\n      element[key] = attrs[key];\n    });\n    return element;\n  });\n\n  tmplTool.props = function (...props) {\n    if (!props) return;\n    props = Object.assign(...props);\n    let propStrArray = [];\n    Object.keys(props).forEach(function (key) {\n      if (props[key]) propStrArray.push(key + '=\"' + props[key] + '\"');\n    });\n    return propStrArray.join(\" \");\n  };\n\n  addTmpl(\"co-Tag\", `##%compomint.tmplTool.tag(data[0], data[1])##`);\n  addTmpl(\n    \"co-Div\",\n    `&lt;div ##=data.id ? 'id=\\\"' + (data.data === true ? tmplScope._id : data.id) + '\\\"' : ''## ##=data.class ? 'class=\\\"' + data.class + '\\\"' : '' ## ##=data.style ? 'style=\\\"' + data.style + '\\\"' : '' ## data-co-event=\\\"##:data.event##\\\"&gt;\n      ##if (typeof data.content === \"string\") {##\n      ##=data.content##\n      ##} else {##\n        ##%data.content##\n      ##}##`\n  );\n\n  addTmpl(\n    \"co-Input\",\n    \"&lt;input name=\\\"##=data.name##\\\" type=\\\"##=data.type##\\\" value=\\\"##=data.value##\\\" ##=data.class ? 'class=\\\"' + data.class + '\\\"' : '' ## ##=data.style ? 'style=\\\"' + data.style + '\\\"' : '' ## data-co-event=\\\"##:data.event##\\\"/&gt;\"\n  );\n  addTmpl(\n    \"co-Select\",\n    `&lt;select name=\\\"##=data.name##\\\" value=\\\"##=data.value##\\\" ##=data.class ? 'class=\\\"' + data.class + '\\\"' : '' ## ##=data.style ? 'style=\\\"' + data.style + '\\\"' : '' ## data-co-event=\\\"##:data.event##\\\"&gt;\n      &lt;option class=\"empty\" value=\"\"&gt;##=data.placeholder##&lt;/option&gt;\n      ##%data.options.map(function(option) { '&lt;option value=\\\"' + option.value + '\\\"' + (data.value == option.value ? 'selected=\\\"\\\"' : '') + '&gt;' + option.label + '&lt;/option&gt;'})##\n      &lt;select/&gt;`\n  );\n  addTmpl(\n    \"co-Template-Viewer\",\n    `<style id=\"style-ct-Base\">\n            .ct-Base h1 {\n              font-size: 24px;\n              font-weight: bold;\n            }\n            .ct-Base h2 {\n              font-size: large;\n              font-weight: bold;\n            }\n            .ct-Base .header {\n              padding: 20px;\n              padding-bottom: 0px;\n              margin-top: 10px;\n            }\n            .ct-Base .menu {\n              margin: 10px;\n              margin-top: 50px;\n              border: 1px solid #cccccc;\n            }\n            .ct-Base .menu li {\n              padding: 10px 14px;\n            }\n            .ct-Base .templateArea {\n              margin: 10px;\n              margin-top: 50px;\n              padding: 10px;\n              border: 1px solid #cccccc\n            }\n            .ct-Base .componentView {\n              margin: 10px;\n            }\n            .ct-Base button {\n              padding: 4px 10px;\n              margin: 4px;\n              border-radius: 0.5rem;\n              border: 1px solid #cccccc;\n            }\n            .ct-Base .hide {\n              display: none;\n            }\n            .ct-Base .templateText :not(pre)>code[class*=language-],\n            .ct-Base .templateText pre[class*=language-] {\n              background: #66990015;\n            }\n            .ct-Base .source :not(pre)>code[class*=language-],\n            .ct-Base .source  pre[class*=language-] {\n              background: #0077aa15;\n            }\n          </style>\n          ##\n          let components = data.components;\n          ##\n          <div class=\"ct-Base\">\n            <div class=\"header\">\n              <h1>##=data.label##</h1>\n              <span>##=data.description##</span>\n            </div>\n            <div style=\"display: flex; gap: 8px;\">\n              <ul class=\"menu\" style=\"\">\n                ##Object.keys(components).forEach(key => {##\n                  <li class=\"\"><a href=\"##='#'+key##\">##=key##</a></li>\n                ##})##\n              </ul>\n              <div class=\"content\">\n                ##Object.keys(components).forEach(key => {\n                  let componentScopes = components[key];\n                  let templateMeta = compomint.tmplCache.get(key);\n                ##\n                <div class=\"templateArea\" id=\"##=key##\" style=\"##=location.hash == '' || location.hash == ('#' + key) ? '' : 'display: none'##;\">\n                  <h2><a href=\"##='#'+key##\">##=key##</a></h2>\n                  ##if (templateMeta) {##\n                  <div style=\"display: flex; gap: 8px;\">\n                    <button data-co-event=\"##:() => templateText.classList.toggle('hide')##\">Template source</button>\n                    <button data-co-event=\"##:() => source.classList.toggle('hide')##\">Compiled source</button>\n                  </div>\n                  <hr>\n                  <div class=\"templateText hide\" data-co-element-ref=\"##:templateText##\">\n                    <h2>Template source</h2>\n                    <pre><code class=\"language-javascript\">##=templateMeta.templateText##</code></pre>\n                  </div>\n                  <hr>\n                  <div class=\"source hide\" data-co-element-ref=\"##:source##\">\n                    <h2>Compiled source</h2>\n                    <pre><code class=\"language-javascript\">##=templateMeta.source##</code></pre>\n                  </div>\n                  ##}##\n\n                  ##componentScopes.forEach(scope => {##\n                  <hr>\n                  <div class=\"componentView\">\n                    <pre><code class=\"language-javascript\">##%scope##</code></pre>\n                    ##%new Function('return '+scope+';')()##\n                  </div>\n                  <hr>\n                  ##})##\n                </div>\n                ##})##\n              </div>\n            </div>\n          </div>\n          ###\n          setTimeout(() => {\n            const anchor = document.getElementById(location.hash.replace('#', ''));\n            if (anchor) {\n              window.scrollTo({\n                top: anchor.getBoundingClientRect().top + window.scrollY,\n              })\n            }\n          });\n          window.onhashchange = () => location.reload();\n          ##`\n  );\n  return { compomint: root.compomint, tmpl: root.tmpl };\n}).call(this);"],"names":["Object","assign","defineProperty","value","target","TypeError","to","index","length","arguments","nextSource","undefined","nextKey","prototype","hasOwnProperty","call","writable","configurable","Element","CharacterData","DocumentType","forEach","item","enumerable","this","parentNode","removeChild","window","Node","get","document","body","contains","root","Compomint","compomint","tmplTool","showTime","debug","requestCacheControl","throwError","cachedTmpl","tmplCache","Map","has","set","elements","Set","isSupportTemplateTag","createElement","tmpl","noMatch","escapes","escaper","firstElementChild","ele","children","childNodes","i","size","childElementCount","Array","filter","child","cleanNode","node","n","nodeType","test","nodeValue","templateSettings","style","pattern","exec","dumy","innerHTML","styleNode","content","querySelector","oldStyleNode","getElementById","id","head","appendChild","commentArea","concat","preEvaluate","tmplId","Function","interpolate","namedElement","key","lazyExec","data","lazyScope","tmplScope","wrapper","namedElementArray","eventId","$elementTrigger","dataset","coNamedElement","elementRef","elementRefArray","func","coVar","elementLoad","elementLoadSplitArray","split","elementLoadArray","coLoad","parentElement","loadFunc","element","customData","component","event","eventStrArray","source","eventArray","eventSplitArray","push","join","self","attacher","selectedArray","coEvent","_loop","selected","eventFunc","trigger","eventName","customEvent","Event","bubbles","cancelable","dispatchEvent","eventData","$childTarget","$targetElement","eventFuncParams","componentElement","addEventListener","stopPropagation","apply","triggerKey","keys","eventType","_eventFunc$eventType","_eventFunc$eventType2","elementSplitArray","elementArray","elementId","childTarget","nonblocking","$tmplElement","docFragment","createDocumentFragment","childElement","stringToElement","beforeAppendTo","parent","parentScope","replaceChild","afterAppendTo","setTimeout","doFunc","node1","DocumentFragment","firstChild","str","isNaN","startsWith","temp","replace","createTextNode","lazyEvaluate","lazyEvaluateArray","selectedFunc","idx","escape","evaluate","dataKeyName","statusKeyName","componentKeyName","i18nKeyName","escapeMap","unescapeMap","createEscaper","escapeHtml","map","match","testRegexp","RegExp","replaceRegexp","string","unescape","matcherFunc","settings","patternArray","execArray","lazyExecArray","setting","lazyExecKeys","lazyScopeSeed","JSON","stringify","escapeFunc","defaultMatcher","templateBuilder","template","templateText","tmplSettings","matcher","text","console","time","_len","params","_key","offset","slice","some","arr","timeEnd","templateParser","renderFunc","e","log","lineNumber","columnNumber","debugErrorLine","wrapperElement","callback","parse","scope","remove","spacer","beforeRemove","afterRemove","appendTo","_id","genId","hasParent","returnTarget","html","i18n","tagName","$props","prop","normalize","liveReloadSupport","createShadowRoot","shadow","styles","sheet","cssRules","cssText","setAttribute","release","props","getOwnPropertyNames","splice","indexOf","render","fdata","newElement","refresh","beforeRefresh","afterRefresh","reflash","tmpl_source","variable","tmplMeta","tmplIdNames","group","groupObj","g","toUpperCase","remapTmpl","json","tmplFunc","safeTemplate","querySelectorAll","addTmpl","addTmpls","removeInnerTemplate","tmplNodes","coLoadScript","addTmplByUrl","importData","option","loadScript","loadStyle","loadLink","importDataParser","obj","url","appendToHead","oldElement","importFunc","links","scripts","scriptText","scriptElm","inlineCode","isArray","arraySize","src","script","tag","async","link","type","rel","href","requestFunc","xmlhttp","XMLHttpRequest","onreadystatechange","readyState","DONE","status","responseText","alert","open","method","timeout","headers","setRequestHeader","send","i18nObj","defaultText","label","documentElement","lang","addI18n","fullKey","langKeyNames","keyLength","subKey","addI18ns","i18nObjs","elementCount","attrs","_len2","_key2","_toConsumableArray","propStrArray"],"mappings":"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"}