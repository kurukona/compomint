{"version":3,"file":"compomint.esm.js","sources":["../src/compomint-core.ts"],"sourcesContent":["/*\n * Copyright (c) 2025-present, Choi Sungho\n * Code released under the MIT license\n */\n\n// Define interfaces for better type safety\ninterface CompomintConfigs {\n  printExecTime?: boolean;\n  debug?: boolean;\n  throwError?: boolean;\n}\n\ninterface TemplateMeta {\n  renderingFunc: RenderingFunction;\n  source?: string;\n  templateText?: string;\n  elements?: Set<any>; // Assuming elements is a Set, adjust type as needed\n}\n\ninterface LazyScope {\n  [key: string]: any[]; // General structure for lazy scope arrays\n  elementPropsArray: any[];\n  namedElementArray: string[];\n  elementRefArray: ((target: Element) => void)[];\n  elementLoadArray: { loadFunc: Function; customData: any }[];\n  eventArray: { eventFunc: Function | Record<string, Function>; $parent: any; customData: any }[][];\n  elementArray: { childTarget: any; nonblocking: boolean | number }[];\n  lazyEvaluateArray: ((data: Record<string, any>) => void)[];\n}\n\ninterface TemplateRule {\n  pattern: RegExp;\n  exec: (...args: any[]) => string;\n  lazyExec?: (data: Record<string, any>, lazyScope: LazyScope, component: ComponentScope, wrapper: DocumentFragment | Element) => void;\n  attacher?: (\n    self: any,\n    data: Record<string, any>,\n    lazyScope: LazyScope,\n    component: ComponentScope,\n    wrapper: DocumentFragment | Element,\n    elementTrigger: Element,\n    eventFunc: Function | Record<string, Function>,\n    eventData: Record<string, any>\n  ) => void;\n  trigger?: (target: Element, eventName: string) => void;\n}\n\n\ninterface TemplateConfig {\n  rules: Record<string, TemplateRule>;\n  keys: {\n    dataKeyName: string,\n    statusKeyName: string,\n    componentKeyName: string,\n    i18nKeyName: string,\n  };\n}\n\ninterface ComponentScope {\n  tmplId: string;\n  _id: string;\n  element: HTMLElement | TemplateElement;\n  wrapperElement?: Element;\n  parentComponent?: ComponentScope;\n  status: Record<string, any>;\n  data: Record<string, any>;\n  trigger?: Record<string, Record<string, () => void>>;\n  [key: string]: any; // Allow arbitrary properties for named elements etc.\n\n  replace(newComponent: ComponentScope | Element): void;\n  remove(spacer?: boolean): Element | TemplateElement | Comment;\n  appendTo(parentElement: Element): ComponentScope;\n  release(): void;\n  render(newData: Record<string, any>): ComponentScope;\n  refresh(reflashData: Record<string, any>): ComponentScope;\n  reflash(reflashData: Record<string, any>): ComponentScope; // Alias for refresh\n\n  // Optional lifecycle hooks\n  beforeRemove?(): void;\n  afterRemove?(): void;\n  beforeAppendTo?(): void;\n  afterAppendTo?(): void;\n  beforeRefresh?(): void;\n  afterRefresh?(): void;\n}\n\ntype RenderingFunction = (\n  data?: any,\n  wrapperElement?: Element | ((component: ComponentScope) => void),\n  callback?: (component: ComponentScope) => void,\n  baseComponent?: Partial<ComponentScope>\n) => ComponentScope;\n\ninterface Tools {\n  escapeHtml: {\n    escape: (str: string) => string;\n    unescape: (str: string) => string;\n  };\n  genId: (tmplId: string) => string;\n  genElement: (tagName: string, attrs?: Record<string, any> | string | Node | (string | Node)[], ...children: (string | Node)[]) => Element;\n  props: (...propsObjects: Record<string, any>[]) => string;\n  liveReloadSupport?: (component: ComponentScope) => void;\n  addTmpl: (tmplId: string, element: Element | string, tmplSettings?: Partial<TemplateConfig>) => RenderingFunction;\n  addTmpls: (source: Element | string, removeInnerTemplate?: boolean | Partial<TemplateConfig>, tmplSettings?: Partial<TemplateConfig>) => Element | TemplateElement;\n  addTmplByUrl: (importData: string | any[] | { url: string; option?: Record<string, any> }, option?: Record<string, any> | (() => void), callback?: () => void) => void;\n}\n\ninterface CompomintGlobal {\n  configs: CompomintConfigs;\n  tmplCache: Map<string, TemplateMeta>;\n  templateConfig: TemplateConfig;\n  tools: Tools;\n  i18n: Record<string, any>;\n  template: (tmplId: string, templateText: string, tmplSettings?: Partial<TemplateConfig>) => RenderingFunction;\n  remapTmpl: (json: Record<string, string>) => void;\n  tmpl: (tmplId: string) => RenderingFunction | null;\n  addTmpl: (tmplId: string, element: Element | string, tmplSettings?: Partial<TemplateConfig>) => RenderingFunction;\n  addTmpls: (source: Element | string, removeInnerTemplate?: boolean | Partial<TemplateConfig>, tmplSettings?: Partial<TemplateConfig>) => Element | TemplateElement;\n  addTmplByUrl: (importData: string | any[] | { url: string; option?: Record<string, any> }, option?: Record<string, any> | (() => void), callback?: () => void) => void;\n  addI18n: (fullKey: string, i18nObj: Record<string, any>) => void;\n  addI18ns: (i18nObjs: Record<string, any>) => void;\n}\n\n\n/*\ndeclare global {\n  namespace globalThis {\n    var compomint: compomintGlobal;\n    var tmpl: Record<string, any>; // Global namespace for template functions\n  }\n  interface Node {\n    prototype: Node;\n    new(): Node;\n  }\n  interface CharacterData {\n    prototype: CharacterData;\n    new(): CharacterData;\n  }\n  interface DocumentType {\n    prototype: DocumentType;\n    new(): DocumentType;\n  }\n  interface TemplateElement extends HTMLTemplateElement { // Define TemplateElement if not globally available\n    prototype: HTMLTemplateElement;\n    new(): HTMLTemplateElement;\n  }\n}\n  */\n\n\n// Ensure TemplateElement is defined for environments like older JSDOM\ninterface TemplateElement extends HTMLTemplateElement { }\n\n\n// Extend Window interface\n\n\n// Polyfill for Object.assign\nif (typeof Object.assign != \"function\") {\n  Object.defineProperty(Object, \"assign\", {\n    value: function assign(target: any, ...params: any[]) {\n      if (target == null) {\n        throw new TypeError(\"Cannot convert undefined or null to object\");\n      }\n      let to = Object(target);\n      for (let index = 0, length = params.length; index < length; index++) {\n        let nextSource = params[index];\n        if (nextSource != null) {\n          for (let nextKey in nextSource) {\n            if (Object.prototype.hasOwnProperty.call(nextSource, nextKey)) {\n              to[nextKey] = nextSource[nextKey];\n            }\n          }\n        }\n      }\n      return to;\n    },\n    writable: true,\n    configurable: true,\n  });\n}\n\n// Polyfill for ChildNode.remove\n(function (arr: any[]) {\n  arr.forEach(function (item) {\n    if (!item || item.hasOwnProperty(\"remove\")) {\n      return;\n    }\n    Object.defineProperty(item, \"remove\", {\n      configurable: true,\n      enumerable: true,\n      writable: true,\n      value: function remove() {\n        if (this.parentNode !== null) {\n          this.parentNode.removeChild(this);\n        }\n      },\n    });\n  });\n})([Element.prototype, CharacterData.prototype, DocumentType.prototype]);\n\n// Polyfill for Node.isConnected\n(function (supported: boolean) {\n  if (supported) return;\n  Object.defineProperty(window.Node.prototype, \"isConnected\", {\n    get: function (): boolean {\n      return document.body.contains(this);\n    },\n  });\n})(\"isConnected\" in window.Node.prototype);\n\n\nconst compomint = ({} as CompomintGlobal);\nconst tmpl = {} as Record<string, any>;\nconst tools = (compomint.tools = compomint.tools || {} as Tools);\nconst configs = (compomint.configs = Object.assign({ printExecTime: false, debug: false, throwError: true }, compomint.configs));\nconst domParser = new DOMParser()\n\nconst cachedTmpl = (compomint.tmplCache = compomint.tmplCache || new Map<string, TemplateMeta>());\nif (!cachedTmpl.has(\"anonymous\")) {\n  cachedTmpl.set(\"anonymous\", { elements: new Set() } as TemplateMeta); // Cast to TemplateMeta\n}\nconst isSupportTemplateTag = \"content\" in document.createElement(\"template\");\n\n\n\nconst noMatch = /(.)^/;\nconst escapes: Record<string, string> = {\n  \"'\": \"\\\\'\",\n  \"\\\\\": \"\\\\\\\\\",\n  \"\\r\": \"\\\\r\",\n  \"\\n\": \"\\\\n\",\n  \"\\t\": \"\\\\t\",\n  \"\\u2028\": \"\\u2028\",\n  \"\\u2029\": \"\\u2029\",\n  \"><\": \"><\",\n  \"<\": \"<\",\n  \">\": \">\",\n};\n\nconst escaper = /\\>( |\\n)+\\<|\\>( |\\n)+|( |\\n)+\\<|\\\\|'|\\r|\\n|\\t|\\u2028|\\u2029/g;\n\nconst firstElementChild = function (ele: Element | DocumentFragment): Element | null {\n  if (ele.firstElementChild) return ele.firstElementChild;\n  const children = ele.childNodes;\n  for (let i = 0, size = children.length; i < size; i++) {\n    if (children[i] instanceof Element) {\n      return children[i] as Element;\n    }\n  }\n  return null;\n};\n\nconst childNodeCount = function (ele: Element | DocumentFragment): number {\n  return (\n    ele.childElementCount ||\n    Array.prototype.filter.call(ele.childNodes, function (child: Node) {\n      return child instanceof Node;\n    }).length\n  );\n};\n\nconst childElementCount = function (ele: Element | DocumentFragment): number {\n  return (\n    ele.childElementCount ||\n    Array.prototype.filter.call(ele.childNodes, function (child: Node) {\n      return child instanceof Element;\n    }).length\n  );\n};\n\nconst cleanNode = function (node: Node): void {\n  for (let n = 0; n < node.childNodes.length; n++) {\n    const child = node.childNodes[n];\n    if (\n      child.nodeType === 8 || // Comment node\n      (child.nodeType === 3 && !/\\S/.test(child.nodeValue || '')) // Text node with only whitespace\n    ) {\n      node.removeChild(child);\n      n--; // Adjust index after removal\n    } else if (child.nodeType === 1) {\n      // Element node\n      cleanNode(child); // Recurse\n    }\n  }\n};\nconst stringToElement = function (str: string | number): Node {\n  if (typeof str === 'number' || !isNaN(Number(str))) {\n    return document.createTextNode(String(str));\n  } else if (typeof str === 'string') {\n    try {\n      const doc = domParser.parseFromString(str, \"text/html\");\n      const body = doc.body;\n      if (body.childNodes.length === 1) {\n        return body.firstChild!;\n      } else {\n        const fragment = document.createDocumentFragment();\n        while (body.firstChild) {\n          fragment.appendChild(body.firstChild);\n        }\n        return fragment;\n      }\n    } catch (e) {\n      return document.createTextNode(str);\n    }\n  } else {\n    return document.createTextNode('');\n  }\n};\n\ncompomint.templateConfig = {\n  rules: {\n    style: {\n      pattern: /(\\<style id=[\\s\\S]+?\\>[\\s\\S]+?\\<\\/style\\>)/g,\n      exec: function (style: string): string {\n        const dumy = document.createElement(\"template\");\n        dumy.innerHTML = style;\n        const styleNode = (dumy.content || dumy).querySelector(\"style\");\n        if (!styleNode || !styleNode.id) return \"\"; // Skip if no style node or ID\n        const oldStyleNode = document.getElementById(styleNode.id);\n        if (oldStyleNode) oldStyleNode.parentNode?.removeChild(oldStyleNode);\n        document.head.appendChild(styleNode);\n        return \"\";\n      },\n    },\n    commentArea: {\n      pattern: /##\\*([\\s\\S]+?)##/g,\n      exec: function (commentArea: string): string {\n        return ``;\n      },\n    },\n    preEvaluate: {\n      pattern: /##!([\\s\\S]+?)##/g,\n      exec: function (preEvaluate: string, tmplId: string): string {\n        try {\n          new Function(\"tmplId\", preEvaluate)(tmplId);\n        } catch (e: any) {\n          if (configs.throwError) {\n            console.error(`Template preEvaluate error in \"${tmplId}\", ${e.name}: ${e.message}`);\n            throw e;\n          } else {\n            console.warn(`Template preEvaluate error in \"${tmplId}\", ${e.name}: ${e.message}`);\n          }\n        }\n        return ``;\n      },\n    },\n    interpolate: {\n      pattern: /##=([\\s\\S]+?)##/g,\n      exec: function (interpolate: string): string {\n        const interpolateSyntax = `typeof (interpolate)=='function' ? (interpolate)() : (interpolate)`;\n        return (`';\\n(() => {let __t, interpolate=${interpolate};\\n__p+=((__t=(${interpolateSyntax}))==null ? '' : String(__t) );})();\\n__p+='`); // Ensure string conversion\n      },\n    },\n    escape: {\n      pattern: /##-([\\s\\S]+?)##/g,\n      exec: function (escape: string): string {\n        const escapeSyntax = `compomint.tools.escapeHtml.escape(typeof (escape)=='function' ? (escape)() : (escape))`;\n        return (`';\\n(() => {let __t, escape=${escape};\\n__p+=((__t=(${escapeSyntax}))==null ? '' : String(__t) );})();\\n__p+='`); // Ensure string conversion before escape\n      },\n    },\n    elementProps: {\n      pattern: /data-co-props=\"##:([\\s\\S]+?)##\"/g,\n      exec: function (props: string): string {\n        const source = `';\\nvar eventId = (__lazyScope.elementPropsArray.length);\\n__p+='data-co-props=\"'+eventId+'\"';\\n\n__lazyScope.elementPropsArray[eventId] = ${props};\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data: Record<string, any>, lazyScope: LazyScope, component: ComponentScope, wrapper: DocumentFragment | Element): void {\n        lazyScope.elementPropsArray.forEach(function (props: Record<string, any> | null, eventId: number) {\n          if (!props) return;\n          const $elementTrigger = wrapper.querySelector<Element>(\n            `[data-co-props=\"${eventId}\"]`\n          );\n          if (!$elementTrigger) return;\n          delete ($elementTrigger as HTMLElement).dataset.coProps;\n          Object.keys(props).forEach(function (key: string) {\n            $elementTrigger.setAttribute(key, String(props[key])); // Ensure value is string\n          });\n        });\n      }\n    },\n    namedElement: {\n      pattern: /data-co-named-element=\"##:([\\s\\S]+?)##\"/g,\n      exec: function (key: string): string {\n        const source = `';\\nvar eventId = (__lazyScope.namedElementArray.length);\\n__p+='data-co-named-element=\"'+eventId+'\"';\\n\n__lazyScope.namedElementArray[eventId] = ${key};\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data: Record<string, any>, lazyScope: LazyScope, component: ComponentScope, wrapper: DocumentFragment | Element): void {\n        lazyScope.namedElementArray.forEach(function (key: string, eventId: number) {\n          const $elementTrigger = wrapper.querySelector<Element>(\n            `[data-co-named-element=\"${eventId}\"]`\n          );\n          if (!$elementTrigger) {\n            if (configs.debug) console.warn(`Named element target not found for ID ${eventId} in template ${component.tmplId}`);\n            return;\n          }\n          delete ($elementTrigger as HTMLElement).dataset.coNamedElement;\n          component[key] = $elementTrigger;\n        });\n      },\n    },\n    elementRef: {\n      pattern: /data-co-element-ref=\"##:([\\s\\S]+?)##\"/g,\n      exec: function (key: string): string {\n        const source = `';\\nvar eventId = (__lazyScope.elementRefArray.length);\\n__p+='data-co-element-ref=\"'+eventId+'\"';\nvar ${key} = null;\\n__lazyScope.elementRefArray[eventId] = function(target) {${key} = target;};\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data: Record<string, any>, lazyScope: LazyScope, component: ComponentScope, wrapper: DocumentFragment | Element): void {\n        lazyScope.elementRefArray.forEach(function (func: (target: Element) => void, eventId: number) {\n          const $elementTrigger = wrapper.querySelector<Element>(\n            `[data-co-element-ref=\"${eventId}\"]`\n          );\n          if (!$elementTrigger) {\n            if (configs.debug) console.warn(`Element ref target not found for ID ${eventId} in template ${component.tmplId}`);\n            return;\n          }\n          delete ($elementTrigger as HTMLElement).dataset.coElementRef;\n          func.call($elementTrigger, $elementTrigger);\n        });\n      },\n    },\n    elementLoad: {\n      pattern: /data-co-load=\"##:([\\s\\S]+?)##\"/g,\n      exec: function (elementLoad: string): string {\n        const elementLoadSplitArray = elementLoad.split(\"::\");\n        const source = `';\\nlet eventId = (__lazyScope.elementLoadArray.length);\\n__p+='data-co-load=\"'+eventId+'\"';\n__lazyScope.elementLoadArray[eventId] = {loadFunc: ${elementLoadSplitArray[0]}, customData: ${elementLoadSplitArray[1]}};\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data: Record<string, any>, lazyScope: LazyScope, component: ComponentScope, wrapper: DocumentFragment | Element): void {\n        lazyScope.elementLoadArray.forEach(function (elementLoad: { loadFunc: Function; customData: Record<string, any> }, eventId: number) {\n          const $elementTrigger = wrapper.querySelector<Element>(\n            `[data-co-load=\"${eventId}\"]`\n          );\n          if (!$elementTrigger) {\n            if (configs.debug) console.warn(`Element load target not found for ID ${eventId} in template ${component.tmplId}`);\n            return;\n          }\n          delete ($elementTrigger as HTMLElement).dataset.coLoad;\n          try {\n            elementLoad.loadFunc.call(\n              $elementTrigger,\n              $elementTrigger,\n              {\n                \"data\": data,\n                \"element\": $elementTrigger,\n                \"customData\": elementLoad.customData,\n                \"component\": component,\n              },\n            );\n          } catch (e: any) {\n            console.error(`Error executing elementLoad function for ID ${eventId} in template ${component.tmplId}:`, e, elementLoad.loadFunc);\n            if (configs.throwError) throw e;\n          }\n        });\n      },\n    },\n    event: {\n      pattern: /data-co-event=\"##:([\\s\\S]+?)##\"/g,\n      exec: function (event: string): string {\n        const eventStrArray = event.split(\":::\");\n        let source = `';\\n(() => {let eventId = (__lazyScope.eventArray.length);\\n__p+='data-co-event=\"'+eventId+'\"';\\n`;\n        const eventArray: string[] = [];\n        for (let i = 0, size = eventStrArray.length; i < size; i++) {\n          const eventSplitArray = eventStrArray[i].split(\"::\");\n          eventArray.push(\n            `{eventFunc: ${eventSplitArray[0]}, $parent: this, customData: ${eventSplitArray[1]}}`\n          );\n        }\n        source += `__lazyScope.eventArray[eventId] = [${eventArray.join(\",\")}];})()\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data: Record<string, any>, lazyScope: LazyScope, component: ComponentScope, wrapper: DocumentFragment | Element): void {\n        const self = this as TemplateRule; // Cast self to TemplateSettings\n        const attacher = self.attacher;\n        if (!attacher) return; // Guard against missing attacher\n\n        lazyScope.eventArray.forEach(function (selectedArray: { eventFunc: Function | Record<string, Function>; $parent: any; customData: any }[], eventId: number) {\n          const $elementTrigger = wrapper.querySelector<Element>(\n            `[data-co-event=\"${eventId}\"]`\n          );\n          if (!$elementTrigger) {\n            if (configs.debug) console.warn(`Event target not found for ID ${eventId} in template ${component.tmplId}`);\n            return;\n          }\n          delete ($elementTrigger as HTMLElement).dataset.coEvent;\n          for (let i = 0, size = selectedArray.length; i < size; i++) {\n            const selected = selectedArray[i];\n            if (selected.eventFunc) {\n              if (Array.isArray(selected.eventFunc)) {\n                selected.eventFunc.forEach(function (func: Function) {\n                  attacher(\n                    self, data, lazyScope, component, wrapper, $elementTrigger,\n                    func,\n                    selected\n                  );\n                });\n              } else {\n                attacher(\n                  self, data, lazyScope, component, wrapper, $elementTrigger,\n                  selected.eventFunc,\n                  selected\n                );\n              }\n            }\n          }\n        });\n      },\n      trigger: function (target: Element, eventName: string): void {\n        const customEvent = new Event(eventName, {\n          bubbles: true,\n          cancelable: true\n        });\n        target.dispatchEvent(customEvent);\n      },\n      attacher: function (\n        self: any, // Type properly if possible\n        data: Record<string, any>,\n        lazyScope: LazyScope,\n        component: ComponentScope,\n        wrapper: DocumentFragment | Element,\n        $elementTrigger: Element,\n        eventFunc: Function | Record<string, Function>,\n        eventData: Record<string, any>\n      ): void {\n        const trigger = self.trigger;\n        const $childTarget = firstElementChild(wrapper);\n        const $targetElement =\n          childElementCount(wrapper) == 1 ? $childTarget : null;\n\n        if (!eventFunc) {\n          return;\n        }\n\n        const eventFuncParams: [Element, Event | Element | null, { data: Record<string, any>; customData: Record<string, any>; element: Element; componentElement: Element | null | undefined; component: ComponentScope }] = [\n          $elementTrigger,\n          null,\n          {\n            \"data\": data,\n            \"customData\": eventData.customData,\n            \"element\": $elementTrigger,\n            \"componentElement\": $targetElement || $childTarget?.parentElement,\n            \"component\": component,\n          },\n        ];\n\n        if (typeof eventFunc === 'function') {\n          $elementTrigger.addEventListener(\"click\", function (event: Event) {\n            event.stopPropagation();\n            eventFuncParams[1] = event;\n            try {\n              eventFunc.call(...eventFuncParams);\n            } catch (e: any) {\n              console.error(`Error in event handler for template ${component.tmplId}:`, e, eventFunc);\n              if (configs.throwError) throw e;\n            }\n          });\n          return;\n        }\n\n        const eventMap = eventFunc as Record<string, Function>;\n        const triggerName = eventMap.triggerName as unknown as string | undefined; // Optional key to store trigger functions\n        if (triggerName) {\n          component.trigger = component.trigger || {};\n          component.trigger[triggerName] = {};\n        }\n\n        Object.keys(eventMap).forEach(function (eventType: string) {\n          if (eventType == \"load\") {\n            eventFuncParams[1] = $elementTrigger;\n            try {\n              eventMap[eventType].call(...eventFuncParams);\n            } catch (e: any) {\n              console.error(`Error in 'load' event handler for template ${component.tmplId}:`, e, eventMap[eventType]);\n              if (configs.throwError) throw e;\n            }\n            return;\n          } else if (eventType == \"namedElement\") {\n            component[eventMap[eventType] as unknown as string] = $elementTrigger;\n            return;\n          } else if (eventType == \"triggerName\") {\n            return;\n          }\n\n          $elementTrigger.addEventListener(eventType, function (event: Event) {\n            event.stopPropagation();\n            eventFuncParams[1] = event;\n            try {\n              eventMap[eventType].call(...eventFuncParams);\n            } catch (e: any) {\n              console.error(`Error in '${eventType}' event handler for template ${component.tmplId}:`, e, eventMap[eventType]);\n              if (configs.throwError) throw e;\n            }\n          });\n\n          if (triggerName && trigger) {\n            component.trigger![triggerName][eventType] = function () {\n              trigger($elementTrigger, eventType);\n            };\n          }\n        });\n      },\n    },\n    element: {\n      pattern: /##%([\\s\\S]+?)##/g,\n      exec: function (target: string): string {\n        const elementSplitArray = target.split(\"::\");\n        const source = `';\\n(() => {\nlet elementId = (__lazyScope.elementArray.length);\n__p+='<template data-co-tmpl-element-id=\"'+elementId+'\"></template>';\n__lazyScope.elementArray[elementId] = {childTarget: ${elementSplitArray[0]}, nonblocking: ${(elementSplitArray[1] || false)}};})();\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data: Record<string, any>, lazyScope: LazyScope, component: ComponentScope, wrapper: DocumentFragment | Element): void {\n        const self = this as TemplateRule; // Cast self\n\n        lazyScope.elementArray.forEach(function (ele: { childTarget: any; nonblocking: boolean | number }, elementId: number) {\n          const childTarget = ele.childTarget;\n          const nonblocking = ele.nonblocking;\n          const $tmplElement = wrapper.querySelector<TemplateElement>(\n            `template[data-co-tmpl-element-id=\"${elementId}\"]`\n          );\n\n          if (!$tmplElement) {\n            if (configs.debug) console.warn(`Element insertion placeholder not found for ID ${elementId} in template ${component.tmplId}`);\n            return;\n          }\n          if (!$tmplElement.parentNode) {\n            if (configs.debug) console.warn(`Element insertion placeholder for ID ${elementId} in template ${component.tmplId} has no parent.`);\n            return;\n          }\n\n          const doFunc = function () {\n            if (!$tmplElement || !$tmplElement.parentNode) {\n              if (configs.debug) console.warn(`Placeholder for ID ${elementId} removed before insertion in template ${component.tmplId}.`);\n              return;\n            }\n\n            try {\n              if (childTarget instanceof Array) {\n                const docFragment = document.createDocumentFragment();\n                childTarget.forEach(function (child: any) {\n                  if (!child) return;\n                  const childElement = child.element || child;\n                  let nodeToAppend: Node | null = null;\n\n                  if (typeof childElement === \"string\" || typeof childElement === \"number\") {\n                    nodeToAppend = stringToElement(childElement);\n                  } else if (typeof childElement === \"function\") {\n                    nodeToAppend = stringToElement(childElement());\n                  } else if (childElement instanceof Node) {\n                    nodeToAppend = childElement;\n                  } else {\n                    if (configs.debug) console.warn(`Invalid item type in element array for ID ${elementId}, template ${component.tmplId}:`, childElement);\n                    return;\n                  }\n\n                  if (child.beforeAppendTo) { try { child.beforeAppendTo(); } catch (e) { console.error(\"Error in beforeAppendTo (array item):\", e); } }\n                  if (nodeToAppend) docFragment.appendChild(nodeToAppend);\n                });\n\n                $tmplElement.parentNode.replaceChild(docFragment, $tmplElement);\n\n                childTarget.forEach(function (child: any) {\n                  if (child && child.afterAppendTo) {\n                    setTimeout(() => {\n                      try { child.afterAppendTo(); } catch (e) { console.error(\"Error in afterAppendTo (array item):\", e); }\n                    }, 0);\n                  }\n                });\n\n              } else if (typeof childTarget === \"string\" || typeof childTarget === \"number\") {\n                $tmplElement.parentNode.replaceChild(\n                  stringToElement(childTarget),\n                  $tmplElement\n                );\n              } else if (typeof childTarget === \"function\") {\n                $tmplElement.parentNode.replaceChild(\n                  stringToElement(childTarget()),\n                  $tmplElement\n                );\n              } else if (childTarget && (childTarget.element || childTarget) instanceof Node) {\n                const childScope = childTarget as ComponentScope; // Assume it might be a scope\n                const childElement = childScope.element || childScope;\n\n                if (childScope.beforeAppendTo) { try { childScope.beforeAppendTo(); } catch (e) { console.error(\"Error in beforeAppendTo:\", e); } }\n                $tmplElement.parentNode.replaceChild(childElement, $tmplElement);\n                if (childScope.afterAppendTo) {\n                  setTimeout(() => {\n                    try {\n                      if (childScope.afterAppendTo) childScope.afterAppendTo();\n                    } catch (e) { console.error(\"Error in afterAppendTo:\", e); }\n                  }, 0);\n                }\n                if (childScope.tmplId) {\n                  childScope.parentComponent = component;\n                }\n\n              } else {\n                if (configs.debug) console.warn(`Invalid target for element insertion ID ${elementId}, template ${component.tmplId}:`, childTarget);\n                $tmplElement.parentNode.removeChild($tmplElement);\n              }\n            } catch (e: any) {\n              console.error(`Error during element insertion for ID ${elementId}, template ${component.tmplId}:`, e);\n              if (configs.throwError) throw e;\n              if ($tmplElement && $tmplElement.parentNode) {\n                try { $tmplElement.parentNode.removeChild($tmplElement); } catch (removeError) { /* Ignore */ }\n              }\n            }\n          }; // end doFunc\n\n          (nonblocking == undefined || nonblocking === false)\n            ? doFunc()\n            : setTimeout(doFunc, typeof nonblocking === 'number' ? nonblocking : 0);\n\n        }); // end forEach\n      }\n    },\n    lazyEvaluate: {\n      pattern: /###([\\s\\S]+?)##/g,\n      exec: function (lazyEvaluate: string): string {\n        const source = `';\\n__lazyScope.lazyEvaluateArray.push(function(data) {${lazyEvaluate}});\\n__p+='`;\n        return source;\n      },\n      lazyExec: function (data: Record<string, any>, lazyScope: LazyScope, component: ComponentScope, wrapper: DocumentFragment | Element): void {\n        const $childTarget = firstElementChild(wrapper);\n        const $targetElement =\n          childElementCount(wrapper) == 1 ? $childTarget : null;\n        lazyScope.lazyEvaluateArray.forEach(function (selectedFunc: (data: Record<string, any>) => void, idx: number) {\n          try {\n            selectedFunc.call($targetElement || wrapper, data); // Use wrapper if multiple elements\n          } catch (e: any) {\n            console.error(`Error in lazyEvaluate block ${idx} for template ${component.tmplId}:`, e, selectedFunc);\n            if (configs.throwError) throw e;\n          }\n        });\n        return;\n      },\n    },\n    evaluate: {\n      pattern: /##([\\s\\S]+?)##/g,\n      exec: (evaluate: string): string => {\n        return \"';\\n\" + evaluate + \"\\n__p+='\";\n      },\n    },\n  },\n  keys: {\n    dataKeyName: \"data\",\n    statusKeyName: \"status\",\n    componentKeyName: \"component\",\n    i18nKeyName: \"i18n\",\n  }\n\n} as TemplateConfig; // Cast to TemplateSettings\n\nconst escapeHtml = (function () {\n  const escapeMap: Record<string, string> = {\n    \"&\": \"&amp;\",\n    \"<\": \"&lt;\",\n    \">\": \"&gt;\",\n    '\"': \"&quot;\",\n    \"'\": \"&#x27;\", // Use HTML entity for single quote\n    \"`\": \"&#x60;\", // Use HTML entity for backtick\n    //\"\\n\": \"&#10;\", // Keep newline escaping if needed, otherwise remove\n  };\n\n  const unescapeMap: Record<string, string> = Object.fromEntries(Object.entries(escapeMap).map(([key, value]) => [value, key]));\n\n  const createEscaper = function (map: Record<string, string>): (str: string) => string {\n    const escaper = function (match: string): string {\n      return map[match];\n    };\n    const source = `(?:${Object.keys(map).join(\"|\").replace(/\\\\/g, '\\\\\\\\')})`; // Escape backslashes if any keys have them\n    const testRegexp = RegExp(source);\n    const replaceRegexp = RegExp(source, \"g\");\n    return function (string: string | null | undefined): string {\n      string = string == null ? \"\" : `${string}`;\n      return testRegexp.test(string)\n        ? string.replace(replaceRegexp, escaper)\n        : string;\n    };\n  };\n\n  return {\n    escape: createEscaper(escapeMap),\n    unescape: createEscaper(unescapeMap),\n  };\n})();\ntools.escapeHtml = escapeHtml;\n\nconst matcherFunc = function (templateRules: Record<string, TemplateRule>): {\n  templateRules: Record<string, TemplateRule>;\n  pattern: RegExp;\n  exec: ((...args: any[]) => string)[];\n  lazyExecKeys: string[];\n  lazyExec: Record<string, (data: Record<string, any>, lazyScope: LazyScope, component: ComponentScope, wrapper: DocumentFragment | Element) => void>;\n  lazyScopeSeed: string;\n} {\n  const patternArray: string[] = [];\n  const execArray: ((...args: any[]) => string)[] = [];\n  const lazyExecMap: Record<string, (data: Record<string, any>, lazyScope: LazyScope, component: ComponentScope, wrapper: DocumentFragment | Element) => void> = {};\n  const lazyScopeSeed: Record<string, any[]> = {};\n\n  Object.keys(templateRules).forEach(function (key) {\n    const templateRule = templateRules[key] as TemplateRule | any; // Type assertion\n    if (templateRule && typeof templateRule === 'object' && templateRule.pattern instanceof RegExp && typeof templateRule.exec === 'function') {\n      patternArray.push((templateRule.pattern || noMatch).source);\n      execArray.push(templateRule.exec);\n    }\n    if (templateRule && typeof templateRule === 'object' && typeof templateRule.lazyExec === 'function') {\n      const arrayKey = `${key}Array`;\n      lazyExecMap[arrayKey] = templateRule.lazyExec;\n      lazyScopeSeed[arrayKey] = [];\n    }\n  });\n  return {\n    templateRules: templateRules,\n    pattern: new RegExp(patternArray.join(\"|\"), \"g\"),\n    exec: execArray,\n    lazyExecKeys: Object.keys(lazyScopeSeed),\n    lazyExec: lazyExecMap,\n    lazyScopeSeed: JSON.stringify(lazyScopeSeed),\n  };\n};\n\nconst escapeFunc = function (match: string): string {\n  return escapes[match] || escapes[match.replace(/[ \\n]/g, \"\")] || \"\";\n};\n\nconst defaultMatcher = matcherFunc(compomint.templateConfig.rules);\n\nconst templateParser = function (tmplId: string, text: string, matcher: ReturnType<typeof matcherFunc>): string {\n  if (configs.printExecTime) console.time(`tmpl: ${tmplId}`);\n\n  let index = 0;\n  let source = \"\";\n\n  text.replace(matcher.pattern, function (...params: any[]): string {\n    const match: string = params[0];\n    const offset: number = params[params.length - 2];\n\n    source += text.slice(index, offset).replace(escaper, escapeFunc);\n\n    let selectedMatchContent: string | undefined;\n    let matchIndex: number | null = null;\n\n    params.slice(1, -2).some(function (value: any, idx: number) {\n      if (value !== undefined) {\n        selectedMatchContent = value;\n        matchIndex = idx;\n        return true;\n      }\n      return false;\n    });\n\n    if (selectedMatchContent !== undefined && matchIndex !== null) {\n      try {\n        source += matcher.exec[matchIndex].call(matcher.templateRules, selectedMatchContent, tmplId);\n      } catch (e: any) {\n        console.error(`Error executing template rule index ${matchIndex} for match \"${selectedMatchContent}\" in template \"${tmplId}\":`, e);\n        if (configs.throwError) throw e;\n        source += '';\n      }\n    } else {\n      source += match.replace(escaper, escapeFunc);\n    }\n\n    index = offset + match.length;\n    return match;\n  });\n\n  source += text.slice(index).replace(escaper, escapeFunc);\n\n  if (configs.printExecTime) console.timeEnd(`tmpl: ${tmplId}`);\n  return source;\n};\n\n\nconst templateBuilder = (compomint.template = function compomint_templateBuilder(\n  tmplId: string,\n  templateText: string,\n  customTemplateConfig?: Partial<TemplateConfig>\n): RenderingFunction {\n  let templateConfig = compomint.templateConfig;\n  let matcher = defaultMatcher;\n\n  if (customTemplateConfig) {\n    templateConfig = Object.assign({}, compomint.templateConfig, customTemplateConfig);\n    matcher = matcherFunc(templateConfig.rules);\n  }\n\n  const source = `\n/* tmplId: ${tmplId} */\n//# sourceURL=http://tmpl//${tmplId.split(\"-\").join(\"//\")}.js\nif (__debugger) {\ndebugger;\n}\nlet __p='';\n__p+='${templateParser(tmplId, templateText, matcher)}';\nreturn __p;`;\n\n  let sourceGenFunc: Function | null = null;\n\n  try {\n    sourceGenFunc = new Function(\n      templateConfig.keys.dataKeyName as string,\n      templateConfig.keys.statusKeyName as string,\n      templateConfig.keys.componentKeyName as string,\n      templateConfig.keys.i18nKeyName as string,\n      \"compomint\",\n      \"tmpl\",\n      \"__lazyScope\",\n      \"__debugger\",\n      source\n    );\n  } catch (e: any) {\n    if (configs.throwError) {\n      console.error(`Template compilation error in \"${tmplId}\", ${e.name}: ${e.message}`);\n      try { // Attempt re-run for potential browser debugging\n        new Function(\n          templateConfig.keys.dataKeyName as string, templateConfig.keys.statusKeyName as string, templateConfig.keys.componentKeyName as string,\n          templateConfig.keys.i18nKeyName as string, \"compomint\", \"tmpl\", \"__lazyScope\", \"__debugger\", source\n        );\n      } catch { /* Ignore re-run error */ }\n      throw e;\n    } else {\n      return (() => ({} as ComponentScope)); // Return a dummy function if not throwing\n    }\n  }\n\n  const renderingFunc: RenderingFunction = function compomint_renderingFuncBuilder(...params): ComponentScope {\n    let data: Record<string, any>;\n    let wrapperElement: Element | undefined;\n    let callback: ((component: ComponentScope) => void) | undefined;\n    let baseComponent: Partial<ComponentScope> | undefined;\n\n    // Argument parsing logic\n    const firstArg = params[0];\n    if (firstArg && typeof firstArg === 'object' && (firstArg.$wrapperElement || firstArg.$callback || firstArg.$baseComponent)) {\n      data = { ...firstArg }; // Clone data object\n      wrapperElement = data.$wrapperElement; delete data.$wrapperElement;\n      callback = data.$callback; delete data.$callback;\n      baseComponent = data.$baseComponent; delete data.$baseComponent;\n    } else {\n      data = firstArg;\n      if (typeof params[1] === 'function') {\n        wrapperElement = undefined;\n        callback = params[1] as ((component: ComponentScope) => void);\n        baseComponent = params[2];\n      } else {\n        wrapperElement = params[1];\n        callback = params[2];\n        baseComponent = params[3];\n      }\n    }\n\n\n    const dataKeyName = templateConfig.keys.dataKeyName as string;\n    const statusKeyName = templateConfig.keys.statusKeyName as string;\n    const lazyScope: LazyScope = JSON.parse(matcher.lazyScopeSeed);\n\n    const component: ComponentScope = Object.assign(baseComponent || {}, {\n      tmplId: tmplId,\n      element: null as any, // Initialize element\n      status: (baseComponent && baseComponent.status) || {}, // Ensure status exists\n      replace: function (newComponent: ComponentScope | Element): void {\n        const self = this as ComponentScope;\n        if (!self.element || !(self.element instanceof Node) || !self.element.parentElement) {\n          if (configs.debug) console.warn(`Cannot replace template \"${tmplId}\": element not in DOM.`);\n          return;\n        }\n        self.element.parentElement.replaceChild(\n          (newComponent as ComponentScope).element || newComponent as Element,\n          self.element as Node\n        );\n      },\n      remove: function (spacer: boolean = false): Element | TemplateElement | Comment | DocumentFragment {\n        const self = this as ComponentScope;\n        if (self.beforeRemove) { try { self.beforeRemove(); } catch (e) { console.error(\"Error in beforeRemove:\", e); } }\n\n        const parent = (self.element instanceof Node) ? self.element.parentElement : null;\n        let removedElement: Element | TemplateElement | Comment | DocumentFragment = self.element; // Store reference\n\n        if (parent) {\n          if (spacer) {\n            const dumy = document.createElement(\"template\");\n            parent.replaceChild(dumy, self.element as Node);\n            self.element = dumy; // Update scope's element reference\n          } else {\n            parent.removeChild(self.element as Node);\n          }\n        } else if (configs.debug) {\n          console.warn(`Cannot remove template \"${tmplId}\": element not in DOM.`);\n        }\n\n        if (self.afterRemove) { try { self.afterRemove(); } catch (e) { console.error(\"Error in afterRemove:\", e); } }\n        return removedElement;\n      },\n      appendTo: function (parentElement: Element): ComponentScope {\n        const self = this as ComponentScope;\n        if (self.beforeAppendTo) { try { self.beforeAppendTo(); } catch (e) { console.error(\"Error in beforeAppendTo:\", e); } }\n\n        if (parentElement && self.element instanceof Node) {\n          parentElement.appendChild(self.element);\n        } else if (configs.debug) {\n          console.warn(`Cannot append template \"${tmplId}\": parentElement or scope.element is missing or not a Node.`);\n        }\n\n        if (self.afterAppendTo) {\n          setTimeout(() => { try { self.afterAppendTo!(); } catch (e) { console.error(\"Error in afterAppendTo:\", e); } }, 0);\n        }\n        return self;\n      },\n      release: function (): void { /* Implementation below */ },\n      render: function (newData: Record<string, any>): ComponentScope { /* Implementation below */ return this; },\n      refresh: function (reflashData: Record<string, any>): ComponentScope { /* Implementation below */ return this; },\n      reflash: function (reflashData: Record<string, any>): ComponentScope { /* Implementation below */ return this; },\n    } as ComponentScope); // Cast to ComponentScope\n\n    if (!component._id) {\n      component._id = tools.genId(tmplId);\n    }\n    component[dataKeyName] = data;\n    if (component[statusKeyName] == undefined) {\n      component[statusKeyName] = {};\n    }\n\n    const hasParent = wrapperElement instanceof Element;\n    const temp = document.createElement(\"template\");\n    let returnTarget: Node | null = null;\n\n    if (configs.printExecTime) console.time(`render: ${tmplId}`);\n\n    let renderedHTML: string | null = null;\n    try {\n      renderedHTML = !data\n        ? `<template data-co-empty-template=\"${tmplId}\"></template>`\n        : sourceGenFunc!.call( // Use non-null assertion\n          wrapperElement || null,\n          data,\n          component[statusKeyName],\n          component,\n          compomint.i18n[tmplId],\n          compomint,\n          tmpl,\n          lazyScope,\n          configs.debug // Pass debug flag for __debugger\n        );\n    } catch (e: any) {\n      if (configs.throwError) {\n        console.error(`Runtime error during render of \"${tmplId}\":`, e.message);\n        console.log(\"--- Data ---\", data, \"------------\");\n        try { // Attempt re-run with debugger\n          sourceGenFunc!.call(wrapperElement || null, data, component[statusKeyName], component, compomint.i18n[tmplId], lazyScope, true);\n        } catch { /* Ignore */ }\n        throw e;\n      } else {\n        console.warn(`Render failed for \"${tmplId}\". Returning scope with comment node.`);\n        component.element = document.createComment(`Render Error: ${tmplId}`) as any;\n        return component;\n      }\n    }\n    if (configs.printExecTime) console.timeEnd(`render: ${tmplId}`);\n\n    temp.innerHTML = renderedHTML!;\n    let docFragment: DocumentFragment | Element | TemplateElement = temp.content || temp;\n\n    if ((docFragment as any).tagName == \"TEMPLATE\" && !(temp as any).content) { // Check for IE11 case\n      const children = Array.from(docFragment.childNodes);\n      docFragment = document.createDocumentFragment();\n      children.forEach(child => docFragment.appendChild(child));\n    }\n\n    const lazyExec = matcher.lazyExec;\n    if (data) {\n      matcher.lazyExecKeys.forEach(function (key) {\n\n        if (lazyScope[key] && lazyScope[key].length > 0) {\n          try {\n            lazyExec[key].call(templateConfig.rules[key.slice(0, -5)], data, lazyScope, component, docFragment as DocumentFragment | Element); // Cast needed\n          } catch (e: any) {\n            if (configs.throwError) {\n              console.error(`Error during lazy execution of \"${key}\" for template \"${tmplId}\":`, e);\n              throw e;\n            }\n          }\n        }\n      });\n    }\n\n    if (hasParent && wrapperElement) {\n      while (wrapperElement.firstChild) {\n        wrapperElement.removeChild(wrapperElement.firstChild);\n      }\n      component.wrapperElement = wrapperElement;\n    }\n\n    // Handle shadow DOM creation\n    const shadowStyle = (docFragment as any).querySelector ? (docFragment as any).querySelector(\"style\") : null;\n    if (shadowStyle && (docFragment as any).querySelector) { // Check if querySelector exists\n      const host = document.createElement(tmplId); // Use tmplId as host tag name\n      try {\n        const shadow = host.attachShadow({ mode: \"open\" });\n        while (docFragment.firstChild) {\n          shadow.appendChild(docFragment.firstChild);\n        }\n        docFragment = host; // Replace fragment with the host element\n      } catch (e) {\n        console.error(`Failed to attach shadow DOM for template \"${tmplId}\":`, e);\n        // Proceed without shadow DOM if attachShadow fails\n      }\n    }\n\n\n    if (docFragment.firstChild && docFragment.firstChild.nodeType == 8) {\n      returnTarget = docFragment.firstChild;\n    } else if (childElementCount(docFragment) == 1) {\n      returnTarget = firstElementChild(docFragment);\n      if (hasParent && wrapperElement && returnTarget) {\n        if (component.beforeAppendTo) { try { component.beforeAppendTo(); } catch (e) { console.error(\"Error in beforeAppendTo:\", e); } }\n        wrapperElement.appendChild(returnTarget);\n        if (component.afterAppendTo) { setTimeout(() => { try { component.afterAppendTo!(); } catch (e) { console.error(\"Error in afterAppendTo:\", e); } }, 0); }\n      }\n    } else {\n      if (hasParent && wrapperElement) {\n        if (component.beforeAppendTo) { try { component.beforeAppendTo(); } catch (e) { console.error(\"Error in beforeAppendTo:\", e); } }\n        wrapperElement.appendChild(docFragment);\n        if (component.afterAppendTo) { setTimeout(() => { try { component.afterAppendTo!(); } catch (e) { console.error(\"Error in afterAppendTo:\", e); } }, 0); }\n        returnTarget = wrapperElement;\n      } else {\n        returnTarget = docFragment;\n      }\n    }\n\n    if (data && data.$props && returnTarget instanceof Element) {\n      for (const prop in data.$props) {\n        try {\n          const value = data.$props[prop];\n          if (prop.startsWith('data-')) {\n            const camelCased = prop.substring(5).replace(/-([a-z])/g, (g) => g[1].toUpperCase());\n            (returnTarget as HTMLElement).dataset[camelCased] = String(value);\n          } else if (prop in returnTarget) {\n            (returnTarget as any)[prop] = value;\n          } else {\n            returnTarget.setAttribute(prop, String(value));\n          }\n        } catch (e: any) {\n          console.error(`Error applying prop \"${prop}\" to element in template \"${tmplId}\":`, e);\n        }\n      }\n    }\n\n    if (returnTarget instanceof Node && returnTarget.normalize) {\n      returnTarget.normalize();\n    }\n    if (returnTarget instanceof Node) {\n      cleanNode(returnTarget);\n    }\n    component.element = returnTarget as HTMLElement | TemplateElement; // Assign final element/fragment\n\n    if (tools.liveReloadSupport) {\n      try { tools.liveReloadSupport(component); } catch (e) { console.error(\"Error in liveReloadSupport:\", e); }\n    }\n\n    if (callback) {\n      try {\n        callback.call(wrapperElement || null, component);\n      } catch (e: any) {\n        console.error(`Error in template callback for \"${tmplId}\":`, e);\n        if (configs.throwError) throw e;\n      }\n    }\n\n    // Define Component Methods (Render/Refresh/Release)\n    component.release = function (): void {\n      const self = this as ComponentScope;\n      const props = Object.getOwnPropertyNames(self);\n      const keepProps = [statusKeyName, '_id'];\n      for (let i = 0; i < props.length; i++) {\n        const prop = props[i];\n        if (typeof (self as any)[prop] !== 'function' && !keepProps.includes(prop)) {\n          delete (self as any)[prop];\n        }\n      }\n    };\n\n    component.render = function (newData: Record<string, any>): ComponentScope {\n      const currentComponent = this as ComponentScope;\n      const targetElement = currentComponent.element;\n      const parent = (targetElement instanceof Node) ? targetElement.parentElement : null;\n      const wrapper = currentComponent.wrapperElement;\n      const tmplFunc = compomint.tmpl(currentComponent.tmplId);\n\n      if (!tmplFunc) {\n        console.error(`Cannot re-render: Template function for \"${currentComponent.tmplId}\" not found.`);\n        return currentComponent;\n      }\n\n      const hooks = {\n        beforeAppendTo: currentComponent.beforeAppendTo, afterAppendTo: currentComponent.afterAppendTo,\n        beforeRemove: currentComponent.beforeRemove, afterRemove: currentComponent.afterRemove,\n        beforeRefresh: currentComponent.beforeRefresh, afterRefresh: currentComponent.afterRefresh\n      };\n\n      if (currentComponent.beforeRemove) { try { currentComponent.beforeRemove(); } catch (e) { console.error(\"Error in beforeRemove during render:\", e); } }\n\n      let newComponent: ComponentScope;\n      if (wrapper) {\n        newComponent = tmplFunc(newData, wrapper, undefined, currentComponent); // Reuse scope object\n      } else if (parent && targetElement instanceof Node) {\n        newComponent = tmplFunc(newData, undefined, undefined, currentComponent); // Reuse scope object\n        if (newComponent.element instanceof Node) {\n          if (newComponent.beforeAppendTo) { try { newComponent.beforeAppendTo(); } catch (e) { console.error(\"Error in beforeAppendTo during render:\", e); } }\n          parent.replaceChild(newComponent.element, targetElement);\n          if (newComponent.afterAppendTo) { setTimeout(() => { try { newComponent.afterAppendTo!(); } catch (e) { console.error(\"Error in afterAppendTo during render:\", e); } }, 0); }\n        } else if (configs.debug) {\n          console.warn(`Re-render of \"${currentComponent.tmplId}\" resulted in no element or target was missing.`);\n        }\n      } else {\n        // No parent, just create new scope (likely detached)\n        newComponent = tmplFunc(newData, undefined, undefined, currentComponent);\n      }\n\n      if (currentComponent.afterRemove) { try { currentComponent.afterRemove(); } catch (e) { console.error(\"Error in afterRemove during render:\", e); } }\n\n      Object.assign(newComponent, hooks); // Restore hooks\n      return newComponent;\n    };\n\n    component.refresh = function (reflashData: Record<string, any>): ComponentScope {\n      const currentComponent = this as ComponentScope;\n      const currentData = currentComponent[dataKeyName];\n      if (currentComponent.beforeRefresh) { try { currentComponent.beforeRefresh(); } catch (e) { console.error(\"Error in beforeRefresh:\", e); } }\n      const newData = Object.assign({}, currentData || {}, reflashData);\n      const newComponent = currentComponent.render(newData);\n      if (currentComponent.afterRefresh) { try { currentComponent.afterRefresh(); } catch (e) { console.error(\"Error in afterRefresh:\", e); } }\n      return newComponent;\n    };\n\n    component.reflash = component.refresh;\n\n    return component;\n  }; // End of renderingFunc definition\n\n  Object.defineProperty(renderingFunc, \"name\", { value: `render_${tmplId}`, writable: false });\n\n  if (tmplId) {\n    const tmplMeta: TemplateMeta = configs.debug ? {\n      renderingFunc: renderingFunc,\n      source: escapeHtml.escape(`function ${tmplId}_source (${templateConfig.keys.dataKeyName}, ${templateConfig.keys.statusKeyName}, ${templateConfig.keys.componentKeyName}, ${templateConfig.keys.i18nKeyName}, __lazyScope, __debugger) {\\n${source}\\n}`),\n      templateText: escapeHtml.escape(templateText),\n    } : {\n      renderingFunc: renderingFunc,\n    };\n    cachedTmpl.set(tmplId, tmplMeta);\n\n    const tmplIdNames = tmplId.split(\"-\");\n    if (tmplIdNames.length > 1) {\n      const group = tmplIdNames[0];\n      let groupObj = tmpl[group];\n      if (!groupObj) {\n        tmpl[group] = groupObj = {};\n      }\n      const tmplIdSub = tmplIdNames\n        .slice(1)\n        .map((part, index) => index === 0 ? part : part.charAt(0).toUpperCase() + part.slice(1))\n        .join('');\n      groupObj[tmplIdSub] = tmplMeta.renderingFunc;\n    }\n  }\n  return renderingFunc;\n}); // End of templateBuilder\n\ncompomint.remapTmpl = function (json: Record<string, string>): void {\n  Object.keys(json).forEach(function (oldKey: string) {\n    const newKey = json[oldKey];\n    const meta = cachedTmpl.get(oldKey);\n    if (meta) {\n      cachedTmpl.set(newKey, meta);\n      if (configs.debug) console.log(`Remapped template \"${oldKey}\" to \"${newKey}\"`);\n    } else if (configs.debug) {\n      console.warn(`Cannot remap template: Old key \"${oldKey}\" not found in cache.`);\n    }\n  });\n};\n\ncompomint.tmpl = function (tmplId: string): RenderingFunction | null {\n  const tmplMeta = cachedTmpl.get(tmplId);\n  return tmplMeta ? tmplMeta.renderingFunc : null;\n};\n\nconst safeTemplate = function (source: Element | string): Element | TemplateElement {\n  let template: TemplateElement;\n  if (source instanceof Element) {\n    if (source.tagName === 'TEMPLATE') return source as TemplateElement;\n    return source; // Assume it's a container element\n  } else if (typeof source !== 'string') {\n    if (configs.debug) console.warn(\"safeTemplate received non-string/non-element source:\", source);\n    source = '';\n  }\n\n  template = document.createElement(\"template\");\n  if (isSupportTemplateTag) {\n    const encodedSource = source.replace(\n      /<(?!template|\\/template|body|\\/body|html|\\/html|head|\\/head|style|\\/style|script|\\/script|link|\\/link|meta|\\/meta|!--)/gi,\n      \"&lt;\"\n    );\n    template.innerHTML = encodedSource;\n  } else {\n    const encodedSource = source\n      .replace(\n        /<(?!template|\\/template|body|\\/body|html|\\/html|head|\\/head|style|\\/style|script|\\/script|link|\\/link|meta|\\/meta|!--)/gi,\n        \"&lt;\"\n      )\n      .replace(/<template/g, '<script type=\"template\"')\n      .replace(/<\\/template>/g, \"</script>\");\n    template.innerHTML = encodedSource;\n  }\n  return template;\n};\n\nconst addTmpl = (compomint.addTmpl = function (tmplId: string, element: Element | string, templateConfig?: Partial<TemplateConfig>): RenderingFunction {\n  let templateText = element instanceof Element ? element.innerHTML : String(element);\n  templateText = escapeHtml.unescape(templateText.replace(/<!---|--->/gi, \"\"));\n  return templateBuilder(tmplId, templateText, templateConfig);\n});\n\nconst addTmpls = (compomint.addTmpls = function (\n  source: Element | string,\n  removeInnerTemplate?: boolean | Partial<TemplateConfig>,\n  templateConfig?: Partial<TemplateConfig>\n): Element | TemplateElement {\n  if (typeof removeInnerTemplate !== \"boolean\" && templateConfig == undefined) {\n    templateConfig = removeInnerTemplate as Partial<TemplateConfig> | undefined;\n    removeInnerTemplate = false;\n  } else {\n    removeInnerTemplate = !!removeInnerTemplate;\n  }\n\n  const container = safeTemplate(source);\n  const content = (container as TemplateElement).content || container; // Use content if available\n  const tmplNodes = content.querySelectorAll<Element>(\n    'template[id], script[type=\"text/template\"][id], script[type=\"text/compomint\"][id]'\n  );\n\n  tmplNodes.forEach(node => {\n    const tmplId = node.id;\n    if (!tmplId) return;\n\n    if ((node as HTMLElement).dataset.coLoadScript !== undefined) {\n      addTmpl(tmplId, node, templateConfig)({}); // Execute immediately if data-co-load-script\n    } else {\n      addTmpl(tmplId, node, templateConfig);\n    }\n\n    if (removeInnerTemplate && node.parentNode) {\n      node.parentNode.removeChild(node);\n    }\n  });\n  return container;\n});\n\nconst addTmplByUrl = (compomint.addTmplByUrl = function compomint_addTmplByUrl(\n  importData: string | any[] | { url: string; option?: Record<string, any> },\n  option?: Record<string, any> | (() => void),\n  callback?: Function | (() => void)\n): void {\n  if (!callback && typeof option === \"function\") {\n    callback = option;\n    option = {};\n  }\n\n  const defaultOptions = {\n    loadScript: true, loadStyle: true, loadLink: true, templateConfig: undefined\n  };\n  const mergedOptions = Object.assign({}, defaultOptions, option as Record<string, any>); // Ensure option is object\n\n  const importDataParser = (obj: string | any): { url: string; option: Record<string, any> } | null => {\n    if (typeof obj === \"string\") {\n      return { url: obj, option: mergedOptions };\n    } else if (obj && typeof obj === 'object' && obj.url) {\n      return { url: obj.url, option: Object.assign({}, mergedOptions, obj.option) };\n    } else {\n      console.error(\"Invalid import data format in addTmplByUrl:\", obj);\n      return null;\n    }\n  };\n\n  const appendElements = (elements: NodeListOf<Element> | Element[]): void => {\n    elements.forEach(element => {\n      if (!element) return;\n      if (element.id) {\n        const oldElement = document.getElementById(element.id);\n        if (oldElement) oldElement.parentNode?.removeChild(oldElement);\n      }\n      if (element.tagName === 'SCRIPT' || element.tagName === 'LINK' || element.tagName === 'STYLE') {\n        document.head.appendChild(element);\n      } else {\n        document.body.appendChild(element);\n      }\n    });\n  };\n\n  const importFunc = (source: string, currentOption: Record<string, any>): void => {\n    const templateContainer = safeTemplate(source);\n    addTmpls(templateContainer, false, currentOption.tmplSettings);\n    const content = (templateContainer as TemplateElement).content || templateContainer;\n\n    if (currentOption.loadLink) {\n      const links = content.querySelectorAll<HTMLLinkElement>('link[rel=\"stylesheet\"]');\n      appendElements(links);\n    }\n    if (currentOption.loadStyle) {\n      const styles = content.querySelectorAll<HTMLStyleElement>(\"style[id]\");\n      appendElements(styles);\n    }\n    if (currentOption.loadScript) {\n      const scripts = content.querySelectorAll<HTMLScriptElement>(\n        'script:not([type]), script[type=\"text/javascript\"], script[type=\"module\"]'\n      );\n      const executableScripts = Array.from(scripts)\n        .filter(node => {\n          let parent = node.parentNode;\n          while (parent) {\n            if (parent.nodeName === 'TEMPLATE' || (parent.nodeName === 'SCRIPT' && (parent as HTMLScriptElement).type.includes('template'))) return false;\n            parent = parent.parentNode;\n          }\n          return true;\n        })\n        .map(node => {\n          const scriptElm = document.createElement(\"script\");\n          node.getAttributeNames().forEach(name => scriptElm.setAttribute(name, node.getAttribute(name)!));\n          if (node.innerHTML) scriptElm.textContent = node.innerHTML;\n          return scriptElm;\n        });\n      appendElements(executableScripts);\n    }\n  };\n\n  const loadResource = (dataItem: string | any): Promise<void> => {\n    return new Promise((resolve, reject) => {\n      const parsedData = importDataParser(dataItem);\n      if (!parsedData) {\n        resolve(); // Resolve immediately for invalid data\n        return;\n      }\n      const src = parsedData.url;\n      const currentOption = parsedData.option;\n\n      if (src.endsWith(\".js\")) {\n        const script = genElement(\"script\", { async: true, src: src }) as HTMLScriptElement;\n        //script.onload = () => resolve();\n        script.onerror = () => { console.error(`Failed to load script: ${src}`); }; // Resolve even on error\n        document.head.appendChild(script);\n        resolve();\n      } else if (src.endsWith(\".css\")) {\n        const link = genElement(\"link\", { type: \"text/css\", rel: \"stylesheet\", href: src }) as HTMLLinkElement;\n        //link.onload = () => resolve(); // CSS load might be unreliable\n        link.onerror = () => { console.error(`Failed to load stylesheet: ${src}`); }; // Resolve even on error\n        document.head.appendChild(link);\n        resolve();\n        // Resolve slightly early for CSS? Or rely on potential browser caching?\n        // For simplicity, let's resolve on load/error.\n      } else {\n        requestFunc(src, null, (source, status) => {\n          if (status === 200 || status === 0) {\n            try {\n              importFunc(source!, currentOption); // Use non-null assertion for source\n            } catch (e) {\n              console.error(`Error processing imported HTML from ${src}:`, e);\n            }\n          } else {\n            console.error(`Failed to fetch template file: ${src} (Status: ${status})`);\n          }\n          resolve(); // Resolve after processing or error\n        });\n      }\n    });\n  };\n\n  const finalCallback = callback || (() => { }); // Ensure callback is a function\n\n  if (Array.isArray(importData)) {\n    if (importData.length === 0) {\n      finalCallback();\n      return;\n    }\n    Promise.all(importData.map(loadResource)).then(finalCallback as ((value: void[]) => void[] | PromiseLike<void[]>)).catch(err => {\n      console.error(\"Error loading resources in addTmplByUrl:\", err);\n      finalCallback(); // Call callback even if some resources failed\n    });\n  } else {\n    loadResource(importData).then(finalCallback as ((value: void) => void[] | PromiseLike<void[]>)).catch(err => {\n      console.error(\"Error loading resource in addTmplByUrl:\", err);\n      finalCallback(); // Call callback even if resource failed\n    });\n  }\n});\n\nconst requestFunc = function (url: string, option: RequestInit | null, callback: (responseText: string | null, status: number, xhr: XMLHttpRequest) => void): void {\n  const xmlhttp = new XMLHttpRequest();\n\n  xmlhttp.onreadystatechange = function () {\n    if (xmlhttp.readyState == XMLHttpRequest.DONE) {\n      if (xmlhttp.status == 200 || xmlhttp.status === 0) {\n        callback(xmlhttp.responseText, xmlhttp.status, xmlhttp);\n      } else {\n        if (xmlhttp.status == 404) console.error(`Error 404: Not Found - ${url}`);\n        else if (xmlhttp.status >= 400) console.error(`HTTP Error ${xmlhttp.status} for ${url}`);\n        else console.error(`Request failed for ${url}`, xmlhttp.statusText);\n        callback(null, xmlhttp.status, xmlhttp);\n      }\n    }\n  };\n\n  xmlhttp.onerror = function () {\n    console.error(`Network error requesting ${url}`);\n    callback(null, 0, xmlhttp);\n  };\n  xmlhttp.ontimeout = function () {\n    console.error(`Request timed out for ${url}`);\n    callback(null, 408, xmlhttp);\n  };\n\n  try {\n    const method = (option && (option as any).method) || \"GET\";\n    xmlhttp.open(method, url, true);\n\n    if (option) {\n      if ((option as any).timeout) xmlhttp.timeout = (option as any).timeout;\n      if (option.headers) {\n        Object.entries(option.headers).forEach(([key, value]) => {\n          xmlhttp.setRequestHeader(key, value);\n        });\n      }\n      xmlhttp.send(option.body as any || null);\n    } else {\n      xmlhttp.send();\n    }\n  } catch (e: any) {\n    console.error(`Error sending request to ${url}:`, e);\n    callback(null, 0, xmlhttp);\n  }\n};\n\ncompomint.i18n = {};\n\ncompomint.addI18n = function (fullKey: string, i18nObj: Record<string, any>): void {\n  if (!fullKey || typeof fullKey !== 'string' || !i18nObj || typeof i18nObj !== 'object') {\n    console.error(\"Invalid arguments for addI18n:\", fullKey, i18nObj);\n    return;\n  }\n\n  const langKeyNames = fullKey.split(\".\");\n  let target: any = compomint.i18n;\n  const keyLength = langKeyNames.length - 1;\n\n  langKeyNames.forEach(function (key: string, i: number) {\n    if (!key) return;\n\n    if (keyLength === i) {\n      if (!target[key]) {\n        target[key] = function (defaultText?: string): string {\n          const lang = document.documentElement.lang || 'en';\n          let label = i18nObj[lang];\n          if (label === undefined || label === null) {\n            label = defaultText;\n            if (configs.debug) console.warn(`i18n: Label key [\"${fullKey}\"] for lang \"${lang}\" is missing. Using default: \"${defaultText}\"`);\n          }\n          return label !== undefined && label !== null ? String(label) : '';\n        };\n      }\n      // Handle nested objects within the language definitions\n      Object.keys(i18nObj)\n        .filter((lang) => i18nObj[lang] instanceof Object && !Array.isArray(i18nObj[lang])) // Check for plain objects\n        .forEach((subKey) => {\n          compomint.addI18n(fullKey + \".\" + subKey, i18nObj[subKey]);\n          // delete i18nObj[subKey]; // Avoid deleting if it's also a language key\n        });\n    } else {\n      if (!target[key]) {\n        target[key] = {};\n      }\n      target = target[key];\n    }\n  });\n};\n\ncompomint.addI18ns = function (i18nObjs: Record<string, any>): void {\n  Object.keys(i18nObjs || {}).forEach(function (key) {\n    compomint.addI18n(key, i18nObjs[key]);\n  });\n};\n\nlet elementCount = 0;\ntools.genId = function (tmplId: string): string {\n  elementCount++;\n  return tmplId + elementCount;\n};\n\nconst genElement = (tools.genElement = function (\n  tagName: string,\n  attrs: Record<string, any> | string | Node | (string | Node)[] = {},\n  ...children: (string | Node)[]\n): Element {\n  const element = document.createElement(tagName);\n  let actualAttrs: Record<string, any> = {};\n\n  if (typeof attrs === 'string') {\n    children.unshift(attrs); // Prepend string as first child\n  } else if (attrs instanceof Node) {\n    children.unshift(attrs); // Prepend Node as first child\n  } else if (Array.isArray(attrs)) {\n    children = attrs.concat(children); // Concatenate arrays\n  } else {\n    actualAttrs = attrs; // It's an attributes object\n  }\n\n  // Set attributes/properties\n  Object.keys(actualAttrs).forEach(function (key) {\n    const value = actualAttrs[key];\n    const propName = key === 'class' ? 'className' : key;\n\n    try {\n      if (key === 'style' && typeof value === 'object' && value !== null) {\n        Object.assign(element.style, value); // Assign style object\n      } else if (key === 'dataset' && typeof value === 'object' && value !== null) {\n        Object.assign((element as HTMLElement).dataset, value); // Assign dataset object\n      } else if (key.startsWith('on') && typeof value === 'function') {\n        // Directly assign event handlers like onclick, onmouseover\n        (element as any)[key.toLowerCase()] = value;\n      } else if (propName in element) {\n        (element as any)[propName] = value;\n      } else {\n        element.setAttribute(key, String(value));\n      }\n    } catch (e: any) {\n      console.error(`Error setting attribute/property \"${key}\" on <${tagName}>:`, e);\n    }\n  });\n\n  // Append children\n  children.forEach(child => {\n    if (typeof child === 'string') {\n      element.appendChild(document.createTextNode(child));\n    } else if (child instanceof Node) {\n      element.appendChild(child);\n    }\n  });\n  return element;\n});\n\ntools.props = function (...propsObjects: Record<string, any>[]): string {\n  if (!propsObjects || propsObjects.length === 0) return \"\";\n  const mergedProps = Object.assign({}, ...propsObjects);\n  const propStrArray: string[] = [];\n  Object.keys(mergedProps).forEach(function (key) {\n    const value = mergedProps[key];\n    if (value || value === 0) {\n      const escapedValue = String(value).replace(/\"/g, '&quot;');\n      propStrArray.push(`${key}=\"${escapedValue}\"`);\n    }\n  });\n  return propStrArray.join(\" \");\n};\n\n// Add built-in components\naddTmpl(\"co-Ele\", `##%compomint.tools.genElement(data[0], data[1])##`);\naddTmpl(\n  \"co-Element\",\n  `##\n  data.tag = data.tag || 'div';\n  ##\n  &lt;##=data.tag##\n    ##=data.id ? 'id=\"' + (data.id === true ? component._id : data.id) + '\"' : ''##\n    data-co-props=\"##:data.props##\"\n    data-co-event=\"##:data.event##\"&gt;\n    ##if (typeof data.content === \"string\") {##\n    ##=data.content##\n    ##} else {##\n      ##%data.content##\n    ##}##\n  &lt;/##=data.tag##&gt;`\n);\n\n\nexport { compomint, tmpl, CompomintGlobal };"],"names":[],"mappings":"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"}